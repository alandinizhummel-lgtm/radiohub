<!DOCTYPE html>
<!--
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  RadioHub v5.0 - Sistema de Ferramentas para Radiologia + Firebase
  Copyright Â© 2026 Dr. Alan Diniz Hummel
  Todos os direitos reservados.
  
  âš ï¸ AVISO LEGAL:
  Este cÃ³digo Ã© de propriedade exclusiva do Dr. Alan Diniz Hummel.
  
  A cÃ³pia, modificaÃ§Ã£o, redistribuiÃ§Ã£o ou uso nÃ£o autorizado deste software
  Ã© ESTRITAMENTE PROIBIDA e constitui violaÃ§Ã£o de direitos autorais,
  sujeita a penalidades civis e criminais conforme a Lei 9.610/98.
  
  O uso deste cÃ³digo sem autorizaÃ§Ã£o expressa e por escrito serÃ¡
  considerado PIRATARIA e resultarÃ¡ em aÃ§Ã£o judicial.
  
  Para licenciamento ou uso autorizado, contate: alandinizhummel@gmail.com
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-->
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RadioHub â€” Ferramentas de Radiologia v5 + Firebase</title>
<!-- Firebase serÃ¡ carregado via ES modules no final do body -->
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;1,400&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;1,9..40,300&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0b0c10;--bg2:#10121a;--surface:#14161f;--surface2:#1a1d28;
  --border:#222533;--border2:#2d3044;
  --accent:#4f8ef7;--accent2:#7aaff9;
  --gold:#c8a84b;
  --text:#e2e5f0;--text2:#8d94b0;--text3:#4a5070;
  --green:#3fc983;--orange:#f0944d;--red:#e05c5c;--purple:#9b79e8;--teal:#38c8c0;
  --serif:'Playfair Display',Georgia,serif;
  --sans:'DM Sans',sans-serif;
  --mono:'DM Mono',monospace;
  --r:12px;--r-sm:7px;--r-xs:4px;
  --hh1:50px;--hh2:40px;--pw:72vw;
}
body.light{
  --bg:#f4f5fa;--bg2:#fff;--surface:#fff;--surface2:#eef0f8;
  --border:#dde1f0;--border2:#c8cde0;
  --text:#1a1d2e;--text2:#4a5070;--text3:#8d94b0;
  --accent:#2d72e8;--accent2:#4f8ef7;--gold:#a07820;
}
body.light .hdr1,body.light .hdr2,body.light .hdr3{background:rgba(244,245,250,0.97);}
body.light .slide-panel{background:#fff;}
body.light .laudo-area,body.light .fi{background:#f4f5fa;color:#1a1d2e;}
body.light select.fi option{background:#fff;}
body.light .frase-full{background:#f4f5fa;}
*{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}
body{background:var(--bg);color:var(--text);font-family:var(--sans);font-size:14px;line-height:1.65;min-height:100vh;overflow-x:hidden;}
::-webkit-scrollbar{width:4px;height:4px;}
::-webkit-scrollbar-track{background:transparent;}
::-webkit-scrollbar-thumb{background:var(--border2);border-radius:2px;}

/* HDR1 */
.hdr1{position:fixed;top:0;left:0;right:0;z-index:310;height:var(--hh1);background:rgba(11,12,16,0.97);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);display:flex;align-items:center;padding:0 1.1rem;gap:1rem;}
.logo{font-family:var(--serif);font-size:1.1rem;color:var(--accent2);cursor:pointer;flex-shrink:0;}
.logo span{font-size:0.58rem;color:var(--text3);letter-spacing:0.1em;text-transform:uppercase;font-family:var(--mono);margin-left:0.35rem;}
.main-nav{display:flex;align-items:center;gap:1px;flex:1;overflow-x:auto;}
.main-nav::-webkit-scrollbar{display:none;}
.mnb{background:none;border:none;color:var(--text3);font-family:var(--sans);font-size:0.75rem;padding:0.32rem 0.65rem;border-radius:var(--r-sm);cursor:pointer;white-space:nowrap;transition:all 0.15s;}
.mnb:hover{color:var(--text);background:var(--surface2);}
.mnb.active{color:var(--accent);background:rgba(79,142,247,0.1);}
.hdr-right{display:flex;align-items:center;gap:0.6rem;flex-shrink:0;}
.theme-btn{background:none;border:1px solid var(--border);border-radius:20px;color:var(--text3);font-size:0.7rem;padding:0.22rem 0.6rem;cursor:pointer;transition:all 0.15s;white-space:nowrap;}
.theme-btn:hover{color:var(--text);}
.vbadge{font-family:var(--mono);font-size:0.56rem;color:var(--text3);border:1px solid var(--border);padding:0.14rem 0.48rem;border-radius:20px;}

/* HDR2 â€” especialidades */
.hdr2{position:fixed;top:var(--hh1);left:0;right:0;z-index:309;height:40px;background:rgba(11,12,16,0.96);backdrop-filter:blur(16px);border-bottom:1px solid var(--border);display:none;align-items:center;padding:0 1.1rem;gap:0.3rem;overflow-x:auto;}
.hdr2::-webkit-scrollbar{display:none;}
.hdr2.visible{display:flex;}
.spb{background:none;border:1px solid transparent;color:var(--text3);font-family:var(--sans);font-size:0.72rem;padding:0.24rem 0.65rem;border-radius:20px;cursor:pointer;white-space:nowrap;transition:all 0.13s;display:flex;align-items:center;gap:0.28rem;}
.spb:hover{color:var(--text);background:var(--surface2);}
.spb.active{color:var(--accent);background:rgba(79,142,247,0.12);border-color:rgba(79,142,247,0.3);}
.spb-div{width:1px;height:16px;background:var(--border);flex-shrink:0;margin:0 0.15rem;}

/* DROPDOWN de subÃ¡reas â€” aparece sob a especialidade clicada */
.sub-dropdown{
  position:fixed;z-index:350;
  background:var(--surface);
  border:1px solid var(--border2);
  border-radius:var(--r);
  padding:0.7rem 0.85rem;
  box-shadow:0 8px 32px rgba(0,0,0,0.35);
  display:none;
  flex-direction:column;
  gap:0.18rem;
  min-width:200px;
  max-width:260px;
  animation:dropIn 0.15s ease;
}
.sub-dropdown.open{display:flex;}
body.light .sub-dropdown{box-shadow:0 8px 28px rgba(0,0,0,0.14);}
@keyframes dropIn{from{opacity:0;transform:translateY(-6px);}to{opacity:1;transform:translateY(0);}}
.sub-dropdown-title{font-size:0.6rem;color:var(--text3);text-transform:uppercase;letter-spacing:0.1em;font-family:var(--mono);margin-bottom:0.3rem;padding-bottom:0.3rem;border-bottom:1px solid var(--border);}
.subb{
  background:none;border:none;
  color:var(--text2);font-family:var(--sans);font-size:0.78rem;
  padding:0.32rem 0.5rem;border-radius:var(--r-xs);
  cursor:pointer;text-align:left;transition:all 0.1s;
  white-space:nowrap;
}
.subb:hover{color:var(--text);background:var(--surface2);}
.subb.active{color:var(--gold);background:rgba(200,168,75,0.09);font-weight:500;}
.subb.all-sub{color:var(--accent2);margin-bottom:0.2rem;}
.subb.all-sub.active{background:rgba(79,142,247,0.1);}
/* pequena seta indicadora no botÃ£o de especialidade quando tem subÃ¡rea aberta */
.spb.has-sub::after{content:'â–¾';font-size:0.6rem;margin-left:0.2rem;opacity:0.6;}

/* APP */
.app{display:flex;margin-top:90px;min-height:calc(100vh - 90px);}
.content{flex:1;min-width:0;padding:1.5rem 1.75rem 5rem;transition:margin-right 0.28s ease;}
.content.panel-open{margin-right:var(--pw);}
.section{display:none;animation:fadeUp 0.2s ease;}
.section.active{display:block;}
@keyframes fadeUp{from{opacity:0;transform:translateY(5px);}to{opacity:1;transform:translateY(0);}}

/* PAINEL â€” 72vw */
.panel-overlay{display:none;position:fixed;inset:0;z-index:400;background:rgba(0,0,0,0.22);}
.panel-overlay.open{display:block;}
.slide-panel{position:fixed;top:90px;right:0;bottom:0;z-index:500;width:var(--pw);max-width:96vw;background:var(--bg2);border-left:1px solid var(--border);display:flex;flex-direction:column;transform:translateX(100%);transition:transform 0.26s cubic-bezier(.4,0,.2,1);}
.slide-panel.open{transform:translateX(0);}
.panel-header{padding:1rem 1.5rem;border-bottom:1px solid var(--border);display:flex;align-items:flex-start;justify-content:space-between;gap:1rem;flex-shrink:0;}
.panel-header-left{flex:1;}
.panel-spec-badge{font-size:0.6rem;color:var(--accent);text-transform:uppercase;letter-spacing:0.08em;font-family:var(--mono);margin-bottom:0.3rem;}
.panel-title{font-family:var(--serif);font-size:1.4rem;color:var(--text);line-height:1.2;}
.panel-tags{display:flex;gap:0.3rem;flex-wrap:wrap;margin-top:0.4rem;}
.panel-close{background:none;border:none;color:var(--text3);font-size:1.1rem;cursor:pointer;padding:0.2rem;transition:color 0.15s;flex-shrink:0;}
.panel-close:hover{color:var(--text);}
.panel-body{flex:1;overflow-y:auto;padding:1.4rem 1.75rem 2rem;}
.panel-body p{font-size:0.85rem;color:var(--text2);margin-bottom:0.65rem;line-height:1.72;}
.panel-body strong{color:var(--text);}
.panel-body ul{padding-left:1.1rem;margin-bottom:0.65rem;}
.panel-body ul li{font-size:0.84rem;color:var(--text2);margin-bottom:0.28rem;}
.panel-body h3{font-family:var(--serif);font-size:1.12rem;color:var(--text);margin:1.1rem 0 0.5rem;font-weight:400;}
.panel-body h4{font-size:0.7rem;color:var(--text3);text-transform:uppercase;letter-spacing:0.07em;margin:0.85rem 0 0.38rem;}
.info-box{background:rgba(79,142,247,0.07);border-left:2px solid var(--accent);border-radius:0 var(--r-xs) var(--r-xs) 0;padding:0.6rem 0.9rem;margin:0.55rem 0;font-size:0.82rem;color:var(--text2);line-height:1.65;}
.warn-box{background:rgba(240,148,77,0.07);border-left:2px solid var(--orange);border-radius:0 var(--r-xs) var(--r-xs) 0;padding:0.6rem 0.9rem;margin:0.55rem 0;font-size:0.82rem;color:var(--text2);line-height:1.65;}
.ok-box{background:rgba(63,201,131,0.07);border-left:2px solid var(--green);border-radius:0 var(--r-xs) var(--r-xs) 0;padding:0.6rem 0.9rem;margin:0.55rem 0;font-size:0.82rem;color:var(--text2);line-height:1.65;}
.pd{height:1px;background:var(--border);margin:1rem 0;}

/* CARDS */
.page-hdr{margin-bottom:1.1rem;}
.page-title{font-family:var(--serif);font-size:clamp(1.4rem,2.5vw,1.85rem);font-weight:400;line-height:1.2;margin-bottom:0.18rem;}
.page-title em{color:var(--accent);font-style:italic;}
.page-sub{font-size:0.74rem;color:var(--text3);}
.search-wrap{position:relative;margin-bottom:1rem;}
.srch{width:100%;background:var(--surface2);border:1px solid var(--border);border-radius:var(--r);color:var(--text);font-family:var(--sans);font-size:0.83rem;padding:0.58rem 1rem 0.58rem 2.4rem;outline:none;transition:border-color 0.15s;}
.srch:focus{border-color:var(--accent);}
.srch-icon{position:absolute;left:0.75rem;top:50%;transform:translateY(-50%);color:var(--text3);pointer-events:none;font-size:0.85rem;}
.card-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(255px,1fr));gap:0.55rem;}
.item-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--r-sm);padding:0.9rem 1rem;cursor:pointer;transition:all 0.14s;display:flex;flex-direction:column;gap:0.2rem;position:relative;}
.item-card:hover{border-color:var(--accent);transform:translateY(-1px);background:var(--surface2);}
.item-card::after{content:'â†’';position:absolute;right:0.8rem;top:50%;transform:translateY(-50%);color:var(--text3);font-size:0.76rem;transition:all 0.14s;}
.item-card:hover::after{color:var(--accent);right:0.62rem;}
.ic-spec{font-size:0.6rem;color:var(--accent);text-transform:uppercase;letter-spacing:0.08em;font-family:var(--mono);}
.ic-name{font-size:0.84rem;font-weight:500;color:var(--text);}
.ic-sub{font-size:0.7rem;color:var(--text3);}
.ic-sub2{font-size:0.66rem;color:var(--gold);font-family:var(--mono);}
.ic-tags{display:flex;gap:0.28rem;flex-wrap:wrap;margin-top:0.18rem;}
.ic-tag{font-size:0.59rem;padding:0.11rem 0.38rem;border-radius:3px;font-weight:500;}
.ic-thumb{width:100%;height:88px;object-fit:cover;border-radius:var(--r-xs);margin-bottom:0.5rem;opacity:0.85;background:var(--surface2);}
.artigo-thumb{width:100%;height:80px;object-fit:cover;border-radius:var(--r-xs);margin-bottom:0.5rem;opacity:0.82;background:var(--surface2);}
.t-tc{background:rgba(79,142,247,0.14);color:var(--accent);}
.t-rm{background:rgba(155,121,232,0.14);color:var(--purple);}
.t-rx{background:rgba(200,168,75,0.12);color:var(--gold);}
.t-us{background:rgba(63,201,131,0.14);color:var(--green);}
.t-pet{background:rgba(240,148,77,0.14);color:var(--orange);}
.t-calc{background:rgba(56,200,192,0.12);color:var(--teal);}
.empty{text-align:center;padding:3rem 1rem;color:var(--text3);font-size:0.83rem;grid-column:1/-1;}
.empty-icon{font-size:2rem;margin-bottom:0.5rem;}

/* HOME */
.hero-t{font-family:var(--serif);font-size:clamp(1.7rem,3vw,2.5rem);line-height:1.15;margin-bottom:0.55rem;}
.hero-t em{color:var(--accent);font-style:italic;}
.hero-sub{font-size:0.81rem;color:var(--text3);max-width:460px;line-height:1.7;margin-bottom:1.2rem;}
.home-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(155px,1fr));gap:1px;background:var(--border);border:1px solid var(--border);border-radius:var(--r);overflow:hidden;margin-bottom:1.6rem;}
.hg-card{background:var(--surface);padding:1.1rem 1rem;cursor:pointer;transition:background 0.14s;}
.hg-card:hover{background:var(--surface2);}
.hg-icon{font-size:1.2rem;margin-bottom:0.45rem;}
.hg-name{font-size:0.81rem;font-weight:500;color:var(--text);margin-bottom:0.1rem;}
.hg-desc{font-size:0.68rem;color:var(--text3);}
.section-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--r);padding:1.2rem 1.4rem;}
.sc-title{font-family:var(--serif);font-size:1rem;margin-bottom:0.18rem;}
.sc-sub{font-size:0.66rem;color:var(--text3);text-transform:uppercase;letter-spacing:0.08em;margin-bottom:0.9rem;}
.upd-feed{display:flex;flex-direction:column;gap:0.4rem;}
.upd{display:flex;gap:0.75rem;align-items:flex-start;padding:0.7rem 0.9rem;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-sm);}
.upd-date{font-family:var(--mono);font-size:0.6rem;color:var(--text3);white-space:nowrap;padding-top:2px;min-width:55px;}
.upd-badge{font-size:0.6rem;padding:0.12rem 0.44rem;border-radius:3px;flex-shrink:0;}
.ub-r{background:rgba(200,168,75,0.12);color:var(--gold);}
.ub-c{background:rgba(56,200,192,0.12);color:var(--teal);}
.ub-g{background:rgba(155,121,232,0.12);color:var(--purple);}
.upd-text{font-size:0.77rem;color:var(--text2);}
.upd-text strong{color:var(--text);}
#visit-ctr{display:inline-flex;align-items:center;gap:0.4rem;background:var(--surface);border:1px solid var(--border);border-radius:20px;padding:0.28rem 0.8rem;margin-bottom:1.3rem;}
#visit-ctr span{font-family:var(--mono);font-size:0.7rem;color:var(--text3);}

/* ARTIGOS */
.artigo-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--r-sm);padding:0.95rem 1.05rem;cursor:pointer;transition:all 0.14s;display:flex;flex-direction:column;gap:0.2rem;}
.artigo-card:hover{border-color:var(--accent);background:var(--surface2);}
.artigo-journal{font-family:var(--mono);font-size:0.6rem;color:var(--gold);text-transform:uppercase;letter-spacing:0.06em;}
.artigo-title{font-size:0.86rem;font-weight:500;color:var(--text);line-height:1.4;}
.artigo-meta{font-size:0.68rem;color:var(--text3);}
.art-abstract{font-size:0.85rem;color:var(--text2);line-height:1.72;background:var(--surface);border:1px solid var(--border);border-radius:var(--r-sm);padding:1rem 1.1rem;margin-bottom:1rem;}
.art-takeaway{background:rgba(79,142,247,0.07);border-left:2px solid var(--accent);border-radius:0 var(--r-xs) var(--r-xs) 0;padding:0.7rem 0.95rem;margin-bottom:0.75rem;}
.art-takeaway-title{font-size:0.66rem;color:var(--accent);text-transform:uppercase;letter-spacing:0.07em;margin-bottom:0.35rem;font-family:var(--mono);}
.art-takeaway ul{padding-left:1rem;}
.art-takeaway ul li{font-size:0.82rem;color:var(--text2);margin-bottom:0.22rem;line-height:1.55;}
.art-doi{font-family:var(--mono);font-size:0.68rem;color:var(--text3);margin-top:0.75rem;}
.art-doi a{color:var(--accent2);text-decoration:none;}

/* CALC */
label.f{display:block;font-size:0.7rem;color:var(--text2);margin-bottom:0.24rem;margin-top:0.7rem;letter-spacing:0.02em;}
label.f:first-child{margin-top:0;}
.fi{width:100%;background:var(--surface);border:1px solid var(--border);border-radius:var(--r-sm);color:var(--text);font-family:var(--sans);font-size:0.83rem;padding:0.5rem 0.72rem;outline:none;transition:border-color 0.15s;}
.fi:focus{border-color:var(--accent);}
select.fi option{background:var(--surface);}
.row2{display:grid;grid-template-columns:1fr 1fr;gap:0.65rem;}
.row3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:0.65rem;}
.calc-btn{display:inline-flex;align-items:center;gap:0.38rem;background:var(--accent);color:#fff;border:none;border-radius:var(--r-sm);padding:0.5rem 1.1rem;font-family:var(--sans);font-size:0.8rem;font-weight:500;cursor:pointer;transition:all 0.14s;margin-top:0.8rem;}
.calc-btn:hover{background:var(--accent2);transform:translateY(-1px);}
.res-box{margin-top:0.8rem;padding:0.9rem 1rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--r-sm);display:none;}
.res-box.show{display:block;}
.res-lbl{font-size:0.62rem;color:var(--text3);text-transform:uppercase;letter-spacing:0.06em;margin-bottom:0.16rem;}
.res-num{font-family:var(--serif);font-size:1.9rem;color:var(--accent);line-height:1;}
.res-unit{font-size:0.7rem;color:var(--text3);margin-top:0.1rem;}
.res-badge{display:inline-block;margin-top:0.48rem;padding:0.24rem 0.68rem;border-radius:20px;font-size:0.72rem;font-weight:500;}
.rb-ok{background:rgba(63,201,131,0.14);color:var(--green);}
.rb-warn{background:rgba(240,148,77,0.14);color:var(--orange);}
.rb-bad{background:rgba(224,92,92,0.14);color:var(--red);}
.rb-info{background:rgba(79,142,247,0.12);color:var(--accent);}
.res-note{font-size:0.74rem;color:var(--text3);margin-top:0.48rem;line-height:1.55;}
.pill-group{display:flex;flex-wrap:wrap;gap:0.3rem;margin-top:0.28rem;}
.pill-r{display:none;}.pill-c{display:none;}
.pill-l{display:inline-block;padding:0.24rem 0.58rem;border:1px solid var(--border);border-radius:20px;font-size:0.7rem;color:var(--text3);cursor:pointer;transition:all 0.12s;}
.pill-r:checked+.pill-l{border-color:var(--accent);color:var(--accent);background:rgba(79,142,247,0.1);}
.pill-c:checked+.pill-l{border-color:var(--gold);color:var(--gold);background:rgba(200,168,75,0.1);}
.tirads-g{display:grid;grid-template-columns:1fr 1fr;gap:0.65rem;}

/* TEMPLATES / MÃSCARAS DE LAUDO */
.laudo-area{
  width:100%;
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:var(--r-sm);
  color:var(--text);
  font-family:var(--sans);
  font-size:0.88rem;
  padding:1.5rem 2rem;
  line-height:1.9;
  resize:vertical;
  min-height:320px;
  outline:none;
  transition:border-color 0.15s;
  white-space:pre-wrap;
  word-wrap:break-word;
}
.laudo-area:focus{border-color:var(--accent);}
.btn-ghost{display:inline-flex;align-items:center;gap:0.3rem;background:transparent;color:var(--text2);border:1px solid var(--border);border-radius:var(--r-sm);padding:0.4rem 0.8rem;font-family:var(--sans);font-size:0.74rem;cursor:pointer;transition:all 0.14s;margin-top:0.55rem;margin-right:0.35rem;}
.btn-ghost:hover{color:var(--text);background:var(--surface2);}

/* FRASES â€” card inline */
.frase-card{
  background:var(--surface);border:1px solid var(--border);
  border-radius:var(--r-sm);padding:0.85rem 1rem;
  transition:all 0.14s;position:relative;
}
.frase-card:hover{border-color:var(--border2);background:var(--surface2);}
.frase-card-top{display:flex;align-items:flex-start;gap:0.5rem;margin-bottom:0.5rem;}
.frase-card-spec{font-size:0.6rem;color:var(--accent);text-transform:uppercase;letter-spacing:0.08em;font-family:var(--mono);}
.frase-card-sub2{font-size:0.66rem;color:var(--gold);font-family:var(--mono);}
.frase-card-actions{display:flex;gap:0.3rem;flex-shrink:0;margin-left:auto;}
.frase-mini-btn{
  background:none;border:1px solid var(--border);
  border-radius:var(--r-xs);color:var(--text3);
  font-size:0.7rem;padding:0.18rem 0.42rem;
  cursor:pointer;transition:all 0.12s;white-space:nowrap;
  display:flex;align-items:center;gap:0.2rem;
}
.frase-mini-btn:hover{color:var(--text);border-color:var(--border2);background:var(--surface2);}
.frase-mini-btn.ref{color:var(--gold);border-color:rgba(200,168,75,0.3);}
.frase-mini-btn.ref:hover{background:rgba(200,168,75,0.08);}
.frase-text{
  font-size:0.82rem;color:var(--text2);line-height:1.7;
  display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;
  overflow:hidden;cursor:copy;border-radius:var(--r-xs);
  padding:0.5rem 0.65rem;background:var(--bg2);
  border:1px solid var(--border);
  transition:border-color 0.12s,background 0.12s;
  position:relative;
}
.frase-text:hover{border-color:var(--accent);background:rgba(79,142,247,0.04);}
.frase-text::after{
  content:'clique para copiar';
  position:absolute;bottom:0.3rem;right:0.5rem;
  font-size:0.58rem;color:var(--text3);opacity:0;
  transition:opacity 0.15s;font-family:var(--mono);
  pointer-events:none;
}
.frase-text:hover::after{opacity:1;}
.frase-text.copied{border-color:var(--green);background:rgba(63,201,131,0.05);}
.frase-tags{display:flex;gap:0.28rem;flex-wrap:wrap;margin-top:0.45rem;}
/* Painel de frase expandida */
.frase-expand-body{}
.frase-full-text{
  font-size:0.88rem;color:var(--text2);line-height:1.8;
  padding:1rem 1.1rem;background:var(--surface);
  border:1px solid var(--border);border-radius:var(--r-sm);
  margin-bottom:1rem;cursor:copy;transition:border-color 0.12s;
  white-space:pre-wrap;
}
.frase-full-text:hover{border-color:var(--accent);}
.frase-copy-big{
  display:inline-flex;align-items:center;gap:0.38rem;
  background:var(--accent);color:#fff;border:none;
  border-radius:var(--r-sm);padding:0.5rem 1.1rem;
  font-family:var(--sans);font-size:0.8rem;cursor:pointer;
  transition:all 0.14s;
}
.frase-copy-big:hover{background:var(--accent2);transform:translateY(-1px);}
.frase-ref-big{
  display:inline-flex;align-items:center;gap:0.38rem;
  background:transparent;color:var(--gold);
  border:1px solid rgba(200,168,75,0.3);border-radius:var(--r-sm);
  padding:0.5rem 1.1rem;font-family:var(--sans);font-size:0.8rem;
  cursor:pointer;transition:all 0.14s;margin-left:0.5rem;
}
.frase-ref-big:hover{background:rgba(200,168,75,0.08);}
/* MODAL de frase expandida */
.frase-modal-overlay{
  display:none;position:fixed;inset:0;z-index:600;
  background:rgba(0,0,0,0.55);backdrop-filter:blur(4px);
  align-items:center;justify-content:center;padding:1.5rem;
}
.frase-modal-overlay.open{display:flex;}
.frase-modal{
  background:var(--bg2);border:1px solid var(--border2);
  border-radius:var(--r);width:100%;max-width:640px;
  max-height:82vh;display:flex;flex-direction:column;
  box-shadow:0 24px 64px rgba(0,0,0,0.5);
  animation:modalIn 0.18s cubic-bezier(.34,1.4,.64,1);
}
body.light .frase-modal{box-shadow:0 16px 48px rgba(0,0,0,0.18);}
@keyframes modalIn{from{opacity:0;transform:scale(0.94);}to{opacity:1;transform:scale(1);}}
.frase-modal-header{
  padding:1rem 1.25rem 0.8rem;
  border-bottom:1px solid var(--border);
  display:flex;align-items:flex-start;justify-content:space-between;gap:1rem;
  flex-shrink:0;
}
.frase-modal-header-left{flex:1;}
.frase-modal-spec{font-size:0.6rem;color:var(--accent);text-transform:uppercase;letter-spacing:0.08em;font-family:var(--mono);margin-bottom:0.22rem;}
.frase-modal-name{font-family:var(--serif);font-size:1.1rem;color:var(--text);line-height:1.25;}
.frase-modal-close{
  background:none;border:none;color:var(--text3);
  font-size:1.1rem;cursor:pointer;padding:0.2rem;
  transition:color 0.15s;flex-shrink:0;
}
.frase-modal-close:hover{color:var(--text);}
.frase-modal-body{flex:1;overflow-y:auto;padding:1.25rem 1.5rem 1.5rem;}
@media(max-width:680px){
  .frase-modal-overlay{padding:0.75rem;}
  .frase-modal{max-width:100%;max-height:90vh;}
  .frase-modal-body{padding:1rem 1.1rem;}
}

/* CHECKLIST */
.chk-item{display:flex;align-items:flex-start;gap:0.5rem;margin-bottom:0.4rem;cursor:pointer;padding:0.2rem 0.3rem;border-radius:var(--r-xs);transition:background 0.12s;}
.chk-item:hover{background:rgba(255,255,255,0.025);}
.cb{width:14px;height:14px;border:1.5px solid var(--border2);border-radius:3px;flex-shrink:0;transition:all 0.12s;display:flex;align-items:center;justify-content:center;margin-top:2px;}
.chk-item.done .cb{background:var(--accent);border-color:var(--accent);}
.chk-item.done .cb::after{content:'âœ“';font-size:8px;color:#fff;font-weight:700;}
.chk-item span{font-size:0.79rem;color:var(--text2);line-height:1.5;}
.chk-item.done span{color:var(--text3);text-decoration:line-through;}
.chk-sec-title{font-size:0.65rem;color:var(--text3);text-transform:uppercase;letter-spacing:0.08em;margin:0.85rem 0 0.42rem;font-family:var(--mono);}
.prog-bar-wrap{background:var(--border);border-radius:2px;height:3px;margin-bottom:0.85rem;}
.prog-fill{height:100%;border-radius:2px;background:var(--accent);transition:width 0.28s;}
.prog-info{display:flex;justify-content:space-between;font-size:0.66rem;color:var(--text3);margin-bottom:0.26rem;}

#toast{position:fixed;bottom:1.4rem;left:50%;transform:translateX(-50%) translateY(56px);background:var(--surface2);border:1px solid var(--border2);padding:0.5rem 1.2rem;border-radius:30px;font-size:0.77rem;color:var(--text);z-index:999;transition:transform 0.24s cubic-bezier(.34,1.56,.64,1);pointer-events:none;}
#toast.show{transform:translateX(-50%) translateY(0);}

@media(max-width:680px){
  .row2,.row3,.tirads-g{grid-template-columns:1fr;}
  .content{padding:1rem 0.85rem 4rem;}
  .content.panel-open{margin-right:0;}
  .slide-panel{width:100%;max-width:100%;top:90px;}
  :root{--pw:100vw;}
}
</style>
</head>
<body>
<div class="hdr1">
  <div class="logo" onclick="_0x7i8j('home',null)">RadioHub<span>v5.1ğŸ”¥</span></div>
  <nav class="main-nav">
    <button class="mnb active" onclick="_0x7i8j('home',this)">âŒ‚ InÃ­cio</button>
    <button class="mnb" onclick="_0x7i8j('resumos',this)">â—ˆ Resumos</button>
    <button class="mnb" onclick="_0x7i8j('artigos',this)">â—‰ Resumo de Artigos</button>
    <button class="mnb" onclick="_0x7i8j('calc',this)">â— Calculadoras</button>
    <button class="mnb" onclick="_0x7i8j('geradores',this)">âŠ Geradores</button>
    <button class="mnb" onclick="_0x7i8j('templates',this)">ğŸ“‹ MÃ¡scaras de Laudo</button>
    <button class="mnb" onclick="_0x7i8j('frases',this)">â Frases</button>
    <button class="mnb" onclick="_0x7i8j('checklist',this)">âœ“ Checklist</button>
  </nav>
  <div class="hdr-right">
    <button class="theme-btn" id="theme-btn" onclick="toggleTheme()">â˜€ï¸ Claro</button>
    <span class="vbadge">v3.1</span>
  </div>
</div>

<div class="hdr2" id="hdr2">
  <button class="spb active" data-spec="all" onclick="setSpec('all',this)">âŠ• Todas</button>
  <button class="spb" data-spec="neuro" onclick="setSpec('neuro',this)">ğŸ§  Neuro</button>
  <button class="spb" data-spec="cn" onclick="setSpec('cn',this)">ğŸ¦· C&P</button>
  <button class="spb" data-spec="gi" onclick="setSpec('gi',this)">ğŸ©º Digestivo</button>
  <button class="spb" data-spec="gu" onclick="setSpec('gu',this)">ğŸ”µ GeniturinÃ¡rio</button>
  <button class="spb" data-spec="msk" onclick="setSpec('msk',this)">ğŸ¦´ MSK</button>
  <button class="spb" data-spec="mama" onclick="setSpec('mama',this)">ğŸ€ Mama</button>
  <button class="spb" data-spec="vasc" onclick="setSpec('vasc',this)">ğŸ’‰ Vascular</button>
  <button class="spb" data-spec="torax" onclick="setSpec('torax',this)">ğŸ« TÃ³rax</button>
  <button class="spb" data-spec="us" onclick="setSpec('us',this)">ğŸ”Š US</button>
  <div class="spb-div"></div>
  <button class="spb" data-spec="contraste" onclick="setSpec('contraste',this)">ğŸ’Š Contraste</button>
</div>

<div class="sub-dropdown" id="sub-dropdown">
  <div class="sub-dropdown-title" id="sub-dropdown-title"></div>
</div>

<div class="app" id="app">
  <main class="content" id="main-content">

    <div id="home" class="section active">
      <div style="padding:1.2rem 0 1.5rem">
        <div class="hero-t">Ferramentas para<br><em>radiologistas</em></div>
        <p class="hero-sub">Calculadoras, resumos, geradores e checklists â€” por especialidade, em painel lateral.</p>
        <div id="visit-ctr"><span>ğŸ‘</span><span>Carregando...</span></div>
      </div>
      <div class="home-grid">
        <div class="hg-card" onclick="_0x7i8j('resumos',document.querySelectorAll('.mnb')[1])"><div class="hg-icon">ğŸ“š</div><div class="hg-name">Resumos</div><div class="hg-desc">Por especialidade</div></div>
        <div class="hg-card" onclick="_0x7i8j('artigos',document.querySelectorAll('.mnb')[2])"><div class="hg-icon">ğŸ“„</div><div class="hg-name">Artigos</div><div class="hg-desc">Resumo de evidÃªncias</div></div>
        <div class="hg-card" onclick="_0x7i8j('calc',document.querySelectorAll('.mnb')[3])"><div class="hg-icon">ğŸ§®</div><div class="hg-name">Calculadoras</div><div class="hg-desc">eGFR Â· TI-RADS Â· BI-RADS</div></div>
        <div class="hg-card" onclick="_0x7i8j('geradores',document.querySelectorAll('.mnb')[4])"><div class="hg-icon">âš™ï¸</div><div class="hg-name">Geradores</div><div class="hg-desc">RM CardÃ­aca</div></div>
        <div class="hg-card" onclick="_0x7i8j('templates',document.querySelectorAll('.mnb')[5])"><div class="hg-icon">ğŸ“‹</div><div class="hg-name">MÃ¡scaras de Laudo</div><div class="hg-desc">Copie e cole no Word</div></div>
        <div class="hg-card" onclick="_0x7i8j('frases',document.querySelectorAll('.mnb')[6])"><div class="hg-icon">ğŸ’¬</div><div class="hg-name">Frases</div><div class="hg-desc">1 clique Â· copiar</div></div>
        <div class="hg-card" onclick="_0x7i8j('checklist',document.querySelectorAll('.mnb')[7])"><div class="hg-icon">âœ…</div><div class="hg-name">Checklist</div><div class="hg-desc">RelatÃ³rios estruturados</div></div>
      </div>
      <div class="section-card">
        <div class="sc-title">Ãšltimas atualizaÃ§Ãµes</div>
        <div class="sc-sub">Novos conteÃºdos e melhorias</div>
        <div class="upd-feed" id="upd-feed"></div>
      </div>
    </div>

    <div id="resumos" class="section">
      <div class="page-hdr"><div class="page-title"><em>Resumos</em></div><div class="page-sub">Filtre por especialidade e subÃ¡rea Â· Clique para abrir no painel</div></div>
      <div class="search-wrap"><span class="srch-icon">ğŸ”</span><input class="srch" type="text" placeholder="Buscar doenÃ§as, achados, modalidades..." oninput="_0x4f5g('resumos',this.value)"></div>
      <div class="card-grid" id="grid-resumos"></div>
    </div>

    <div id="artigos" class="section">
      <div class="page-hdr"><div class="page-title"><em>Resumo</em> de Artigos</div><div class="page-sub">EvidÃªncias recentes com take-aways prÃ¡ticos Â· Por especialidade</div></div>
      <div class="search-wrap"><span class="srch-icon">ğŸ”</span><input class="srch" type="text" placeholder="Buscar por tÃ­tulo, journal, autor..." oninput="_0x4f5g('artigos',this.value)"></div>
      <div class="card-grid" id="grid-artigos"></div>
    </div>

    <div id="calc" class="section">
      <div class="page-hdr"><div class="page-title"><em>Calculadoras</em></div><div class="page-sub">Filtre por especialidade e subÃ¡rea</div></div>
      <div class="search-wrap"><span class="srch-icon">ğŸ”</span><input class="srch" type="text" placeholder="Buscar calculadoras..." oninput="_0x4f5g('calc',this.value)"></div>
      <div class="card-grid" id="grid-calc"></div>
    </div>

    <div id="geradores" class="section">
      <div class="page-hdr"><div class="page-title"><em>Geradores</em> de Laudo</div><div class="page-sub">Ferramentas interativas</div></div>
      <div class="search-wrap"><span class="srch-icon">ğŸ”</span><input class="srch" type="text" placeholder="Buscar geradores..." oninput="_0x4f5g('geradores',this.value)"></div>
      <div class="card-grid" id="grid-geradores"></div>
    </div>

    <div id="templates" class="section">
      <div class="page-hdr"><div class="page-title"><em>MÃ¡scaras de Laudo</em></div><div class="page-sub">Formatado para Word Â· Copie com 1 clique</div></div>
      <div class="search-wrap"><span class="srch-icon">ğŸ”</span><input class="srch" type="text" placeholder="Buscar templates..." oninput="_0x4f5g('templates',this.value)"></div>
      <div class="card-grid" id="grid-templates"></div>
    </div>

    <div id="frases" class="section">
      <div class="page-hdr"><div class="page-title"><em>Frases</em>-padrÃ£o</div><div class="page-sub">Copiar com 1 clique</div></div>
      <div class="search-wrap"><span class="srch-icon">ğŸ”</span><input class="srch" type="text" placeholder="Buscar frases..." oninput="_0x4f5g('frases',this.value)"></div>
      <div class="card-grid" id="grid-frases"></div>
    </div>

    <div id="checklist" class="section">
      <div class="page-hdr"><div class="page-title"><em>Checklist</em></div><div class="page-sub">Marque os itens avaliados</div></div>
      <div class="search-wrap"><span class="srch-icon">ğŸ”</span><input class="srch" type="text" placeholder="Buscar checklists..." oninput="_0x4f5g('checklist',this.value)"></div>
      <div class="card-grid" id="grid-checklist"></div>
    </div>

  </main>
</div>

<div class="panel-overlay" id="panel-overlay" onclick="_0x6h7i()"></div>
<div class="slide-panel" id="slide-panel">
  <div class="panel-header">
    <div class="panel-header-left">
      <div class="panel-spec-badge" id="panel-spec-badge"></div>
      <div class="panel-title" id="panel-title"></div>
      <div class="panel-tags" id="panel-tags"></div>
    </div>
    <button class="panel-close" onclick="_0x6h7i()">âœ•</button>
  </div>
  <div class="panel-body" id="panel-body"></div>
</div>
<div id="toast"></div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// COPYRIGHT PROTECTION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
console.log('%câ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”', 'color: #4f8ef7;');
console.log('%câš ï¸  RADIOHUB v4.0', 'color: #f0944d; font-size: 20px; font-weight: bold; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);');
console.log('%câ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”', 'color: #4f8ef7;');
console.log('%c\nÂ© 2026 Dr. Alan Diniz Hummel - TODOS OS DIREITOS RESERVADOS\n', 'color: #e2e5f0; font-size: 14px; font-weight: bold;');
console.log('%câš–ï¸  AVISO LEGAL:', 'color: #e05c5c; font-size: 13px; font-weight: bold;');
console.log('%cEste cÃ³digo Ã© propriedade intelectual protegida por direitos autorais.', 'color: #8d94b0; font-size: 12px;');
console.log('%cCÃ³pia, modificaÃ§Ã£o ou redistribuiÃ§Ã£o NÃƒO AUTORIZADA Ã© CRIME (Lei 9.610/98).', 'color: #8d94b0; font-size: 12px;');
console.log('%cVioladores serÃ£o processados civil e criminalmente.\n', 'color: #e05c5c; font-size: 12px; font-weight: bold;');
console.log('%cğŸ“§ Contato para licenciamento: alandinizhummel@gmail.com\n', 'color: #3fc983; font-size: 11px;');
console.log('%câ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”', 'color: #4f8ef7;');

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FIREBASE CONFIG ğŸ”¥ (Supabase removido)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Firebase Ã© carregado via ES modules no final do HTML
// Use: loadFirebaseTemplates(), loadFirebaseFrases(), loadFirebaseChecklists(), loadFirebaseResumos()


// ============================================
// SPECS
// ============================================
const SPECS={
  all:{label:'Todas',icon:'âŠ•',subs:[]},
  neuro:{label:'Neurorradiologia',icon:'ğŸ§ ',subs:[
    'EncÃ©falo','AVC/Isquemia','Neoplasias Intracranianas','InfecÃ§Ã£o/InflamaÃ§Ã£o','Trauma Craniano',
    'MalformaÃ§Ãµes Vasculares','Coluna Cervical','Coluna TorÃ¡cica','Coluna Lombossacra',
    'Vascular Cerebral','Nervos Cranianos','Pediatria Neuro'
  ]},
  cn:{label:'CabeÃ§a e PescoÃ§o',icon:'ğŸ¦·',subs:[
    'Tireoide/Paratireoide','Laringe/Faringe','Cavidade Oral/MandÃ­bula',
    'Ã“rbita/Globo Ocular','Ouvido/Mastoide','GlÃ¢ndulas Salivares',
    'EspaÃ§os Cervicais','Linfonodos Cervicais'
  ]},
  gi:{label:'Abdome Â· Digestivo',icon:'ğŸ©º',subs:[
    'FÃ­gado','Vias Biliares/VesÃ­cula','PÃ¢ncreas',
    'BaÃ§o','EstÃ´mago/EsÃ´fago','Intestino Delgado',
    'CÃ³lon/Reto','PeritÃ´nio/MesentÃ©rio','Abdome Agudo'
  ]},
  gu:{label:'Abdome Â· GeniturinÃ¡rio',icon:'ğŸ”µ',subs:[
    'Rins','Adrenal','Bexiga','Ureter/Pelve Renal',
    'PrÃ³stata','TestÃ­culo/EpidÃ­dimo','PÃªnis',
    'Ãštero/OvÃ¡rios','RetroperitÃ´nio'
  ]},
  msk:{label:'MÃºsculo-EsquelÃ©tica',icon:'ğŸ¦´',subs:[
    'Ombro','Cotovelo','Punho/MÃ£o',
    'Quadril','Joelho','Tornozelo/PÃ©',
    'Coluna MSK','Partes Moles/MÃºsculo','Tumores Ã“sseos/Partes Moles'
  ]},
  mama:{label:'MamÃ¡ria',icon:'ğŸ€',subs:[
    'Mamografia','US Mama','RM Mama',
    'BI-RADS','Mama Masculina','IntervenÃ§Ã£o/BiÃ³psia Mama'
  ]},
  vasc:{label:'Vascular e Interv.',icon:'ğŸ’‰',subs:[
    'Aorta TorÃ¡cica','Aorta Abdominal','ArtÃ©rias PerifÃ©ricas',
    'Veias/TEP','TÃ³rax/PulmÃ£o Vascular',
    'IntervenÃ§Ã£o Arterial','IntervenÃ§Ã£o Venosa','IntervenÃ§Ã£o NÃ£o Vascular'
  ]},
  torax:{label:'TÃ³rax',icon:'ğŸ«',subs:[
    'ParÃªnquima Pulmonar','NÃ³dulo/Massa Pulmonar','InfecÃ§Ã£o/Pneumonia',
    'InterstÃ­cio/Fibrose','DPOC/Enfisema','Derrame Pleural/Empiema',
    'Mediastino','Pleura','Trauma TorÃ¡cico','Pediatria TÃ³rax'
  ]},
  us:{label:'Ultrassonografia',icon:'ğŸ”Š',subs:[
    'Abdome Geral','Cervical/Tireoide','Ginecologia',
    'ObstetrÃ­cia','Doppler','MÃºsculo-esquelÃ©tico US',
    'Rins/Vias/PrÃ³stata','TestÃ­culo/PÃªnis',
    'TÃ³rax US','Globo Ocular','Transfontanelar',
    'Procedimentos US','Pediatria US'
  ]},
  contraste:{label:'Contraste',icon:'ğŸ’Š',subs:['Iodado','GadolÃ­nio','ReaÃ§Ãµes/Profilaxia']}
};

const LP1='Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.';
const LP2='At vero eos et accusamus et iusto odio dignissimos ducimus, qui blanditiis praesentium voluptatum deleniti atque corrupti. Quos dolores et quas molestias excepturi sint occaecati cupiditate non provident, similique sunt in culpa.';
const LP3='Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt, explicabo.';
const LP4='Nemo enim ipsam voluptatem, quia voluptas sit, aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos, qui ratione voluptatem sequi nesciunt. Neque porro quisquam est, qui dolorem ipsum, quia dolor sit.';
const LP5='Temporibus autem quibusdam et aut officiis debitis aut rerum necessitatibus saepe eveniet, ut et voluptates repudiandae sint et molestiae non recusandae. Itaque earum rerum hic tenetur a sapiente delectus ut aut reiciendis.';

function ph(t1,t2,t3,extra){
  t1=t1||'Achados por Imagem';t2=t2||'DiagnÃ³stico Diferencial';t3=t3||'Conduta e Seguimento';
  return`<p style="color:var(--orange);font-size:0.75rem;font-style:italic;margin-bottom:1.1rem;display:flex;align-items:center;gap:0.4rem"><span>âš ï¸</span> ConteÃºdo em elaboraÃ§Ã£o â€” substitua pelo resumo clÃ­nico real.</p>
<h3>${t1}</h3><p>${LP1}</p><p>${LP2}</p>
<div class="info-box"><strong>PÃ©rola clÃ­nica:</strong> ${LP3}</div>
<h3>${t2}</h3><p>${LP4}</p>
<ul><li>Lorem ipsum dolor sit amet, consectetur adipiscing.</li><li>Sed do eiusmod tempor incididunt ut labore et dolore.</li><li>Ut enim ad minim veniam quis nostrud exercitation.</li></ul>
${extra||''}
<div class="warn-box"><strong>âš ï¸ AtenÃ§Ã£o:</strong> ${LP5}</div>
<h3>${t3}</h3><p>${LP2}</p>
<div class="ok-box">âœ“ Seguimento recomendado: substituir pelo protocolo real desta doenÃ§a/condiÃ§Ã£o.</div>`;
}

function artPh(journal,year,theme){
  theme=theme||'Lorem Ipsum';
  return`<div class="art-abstract">
<p><strong>Objetivo:</strong> ${LP1}</p>
<p><strong>MÃ©todos:</strong> ${LP2}</p>
<p><strong>Resultados:</strong> ${LP3}</p>
<p><strong>ConclusÃ£o:</strong> ${LP4}</p>
</div>
<div class="art-takeaway"><div class="art-takeaway-title">ğŸ“Œ Take-aways prÃ¡ticos</div><ul>
<li>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore.</li>
<li>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo.</li>
<li>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</li>
</ul></div>
<div class="pd"></div>
<p style="font-size:0.78rem;color:var(--text3)">âš ï¸ Em elaboraÃ§Ã£o â€” substitua pelo artigo real com DOI correto.</p>
<div class="art-doi">DOI: <a href="#" onclick="return false">[inserir DOI]</a></div>`;
}

const DR=[
  {id:'r-neuro-1',spec:'neuro',sub2:'EncÃ©falo',name:'[Resumo EncÃ©falo 1]',sub:'Neurorradiologia Â· EncÃ©falo',tags:['TC','RM'],
   img:'https://upload.wikimedia.org/wikipedia/commons/thumb/5/56/CT_brain_hemorrhage.jpg/320px-CT_brain_hemorrhage.jpg',body:ph('Achados na TC/RM de CrÃ¢nio','DiagnÃ³stico Diferencial','Conduta')},
  {id:'r-neuro-2',spec:'neuro',sub2:'EncÃ©falo',name:'[Resumo EncÃ©falo 2]',sub:'Neurorradiologia Â· EncÃ©falo',tags:['RM'],
   img:'https://upload.wikimedia.org/wikipedia/commons/thumb/9/9f/MRI_brain_normal_axial_T1.jpg/320px-MRI_brain_normal_axial_T1.jpg',body:ph('ApresentaÃ§Ã£o na RM','DiagnÃ³stico Diferencial','Seguimento')},
  {id:'r-neuro-3',spec:'neuro',sub2:'Coluna Cervical',name:'[Resumo Coluna Cervical]',sub:'Neurorradiologia Â· Coluna',tags:['RM'],body:ph('Achados na RM de Coluna','Diferencial','Conduta')},
  {id:'r-neuro-4',spec:'neuro',sub2:'Vascular Cerebral',name:'[Resumo Vascular Cerebral 1]',sub:'Neurorradiologia Â· Vascular',tags:['TC','RM'],body:ph('Angiografia e TC','Diferencial Vascular','Conduta Urgente')},
  {id:'r-cn-1',spec:'cn',sub2:'Tireoide/Paratireoide',name:'[Resumo Tireoide 1]',sub:'C&P Â· Tireoide',tags:['US'],
   img:'https://upload.wikimedia.org/wikipedia/commons/thumb/9/9e/Thyroid_ultrasound.jpg/320px-Thyroid_ultrasound.jpg',body:ph('Achados no US','DiagnÃ³stico Diferencial','Conduta TI-RADS')},
  {id:'r-cn-2',spec:'cn',sub2:'Tireoide/Paratireoide',name:'[Resumo Tireoide 2]',sub:'C&P Â· Tireoide',tags:['US','RM'],body:ph()},
  {id:'r-cn-3',spec:'cn',sub2:'Laringe/Faringe',name:'[Resumo Laringe 1]',sub:'C&P Â· Laringe',tags:['TC','RM'],body:ph()},
  {id:'r-gi-1',spec:'gi',sub2:'FÃ­gado',name:'[Resumo FÃ­gado 1]',sub:'Digestivo Â· FÃ­gado',tags:['TC','RM'],
   img:'https://upload.wikimedia.org/wikipedia/commons/thumb/1/1c/Hepatocellular_carcinoma_CT.jpg/320px-Hepatocellular_carcinoma_CT.jpg',body:ph('TC MultifÃ¡sico e RM','Diferencial de NÃ³dulos HepÃ¡ticos','LI-RADS e Seguimento')},
  {id:'r-gi-2',spec:'gi',sub2:'FÃ­gado',name:'[Resumo FÃ­gado 2]',sub:'Digestivo Â· FÃ­gado',tags:['RM'],body:ph()},
  {id:'r-gi-3',spec:'gi',sub2:'PÃ¢ncreas',name:'[Resumo PÃ¢ncreas 1]',sub:'Digestivo Â· PÃ¢ncreas',tags:['TC','US'],body:ph('Achados na TC','DiagnÃ³stico Diferencial','Estadiamento')},
  {id:'r-gi-4',spec:'gi',sub2:'CÃ³lon/Reto',name:'[Resumo CÃ³lon 1]',sub:'Digestivo Â· CÃ³lon',tags:['TC'],body:ph()},
  {id:'r-gu-1',spec:'gu',sub2:'Rins',name:'[Resumo Rins 1]',sub:'GeniturinÃ¡rio Â· Rins',tags:['TC','US'],
   img:'https://upload.wikimedia.org/wikipedia/commons/thumb/c/c2/Renal_cell_carcinoma_CT.jpg/320px-Renal_cell_carcinoma_CT.jpg',body:ph('US e TC Renal','DiagnÃ³stico Diferencial','Bosniak / Conduta')},
  {id:'r-gu-2',spec:'gu',sub2:'Rins',name:'[Resumo Rins 2]',sub:'GeniturinÃ¡rio Â· Rins',tags:['RM','TC'],body:ph()},
  {id:'r-gu-3',spec:'gu',sub2:'Adrenal',name:'[Resumo Adrenal 1]',sub:'GeniturinÃ¡rio Â· Adrenal',tags:['TC','RM'],body:ph()},
  {id:'r-gu-4',spec:'gu',sub2:'Ãštero/OvÃ¡rios',name:'[Resumo GenitÃ¡lia Fem. 1]',sub:'GeniturinÃ¡rio Â· Ginecologia',tags:['US','RM'],body:ph()},
  {id:'r-msk-1',spec:'msk',sub2:'Ombro',name:'[Resumo Ombro 1]',sub:'MSK Â· Ombro',tags:['RM','US'],
   img:'https://upload.wikimedia.org/wikipedia/commons/thumb/a/a0/MRI_shoulder.jpg/320px-MRI_shoulder.jpg',body:ph('RM do Ombro â€” SequÃªncias','Diferencial do Manguito','Conduta')},
  {id:'r-msk-2',spec:'msk',sub2:'Ombro',name:'[Resumo Ombro 2]',sub:'MSK Â· Ombro',tags:['RM'],body:ph()},
  {id:'r-msk-3',spec:'msk',sub2:'Joelho',name:'[Resumo Joelho 1]',sub:'MSK Â· Joelho',tags:['RM'],body:ph()},
  {id:'r-msk-4',spec:'msk',sub2:'Coluna MSK',name:'[Resumo Coluna MSK 1]',sub:'MSK Â· Coluna',tags:['RM','TC'],body:ph()},
  {id:'r-mama-1',spec:'mama',sub2:'US Mama',name:'[Resumo US Mama 1]',sub:'Mama Â· US',tags:['US'],
   img:'https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Breast_ultrasound.jpg/320px-Breast_ultrasound.jpg',body:ph('US Mama â€” Achados','BI-RADS Diferencial','Conduta')},
  {id:'r-mama-2',spec:'mama',sub2:'US Mama',name:'[Resumo US Mama 2]',sub:'Mama Â· US',tags:['US'],body:ph()},
  {id:'r-mama-3',spec:'mama',sub2:'Mamografia',name:'[Resumo Mamografia 1]',sub:'Mama Â· Mamografia',tags:['RX'],body:ph()},
  {id:'r-vasc-1',spec:'vasc',sub2:'TÃ³rax/PulmÃ£o Vascular',name:'[Resumo TEP 1]',sub:'Vascular Â· TEP',tags:['TC'],
   img:'https://upload.wikimedia.org/wikipedia/commons/thumb/6/62/Pulmonary_embolism_CT.jpg/320px-Pulmonary_embolism_CT.jpg',body:ph('Angio-TC de TÃ³rax','DiagnÃ³stico Diferencial','Escore Wells e Conduta')},
  {id:'r-vasc-2',spec:'vasc',sub2:'Aorta TorÃ¡cica',name:'[Resumo Aorta 1]',sub:'Vascular Â· Aorta',tags:['TC','RM'],body:ph()},
  {id:'r-vasc-3',spec:'vasc',sub2:'Aorta Abdominal',name:'[Resumo AAA 1]',sub:'Vascular Â· Aorta Abdominal',tags:['TC'],body:ph()},
  // TÃ“RAX
  {id:'r-tx-1',spec:'torax',sub2:'ParÃªnquima Pulmonar',name:'[Protocolo TC TÃ³rax]',sub:'TÃ³rax Â· ParÃªnquima',tags:['TC'],
   img:'https://upload.wikimedia.org/wikipedia/commons/thumb/f/f8/Chest_CT_scan.jpg/320px-Chest_CT_scan.jpg',body:ph('PadrÃµes na TC de TÃ³rax','DiagnÃ³stico Diferencial por PadrÃ£o','Conduta')},
  {id:'r-tx-2',spec:'torax',sub2:'ParÃªnquima Pulmonar',name:'[NÃ³dulo Pulmonar SolitÃ¡rio]',sub:'TÃ³rax Â· NÃ³dulo',tags:['TC'],
   img:'https://upload.wikimedia.org/wikipedia/commons/thumb/8/85/Lung_CT_nodule.jpg/320px-Lung_CT_nodule.jpg',body:ph('CaracterÃ­sticas do NÃ³dulo','Diferencial Benigno x Maligno','Fleischner Society 2017')},
  {id:'r-tx-3',spec:'torax',sub2:'InfecÃ§Ã£o/Pneumonia',name:'[Pneumonia â€” PadrÃµes TC]',sub:'TÃ³rax Â· InfecÃ§Ã£o',tags:['TC','RX'],body:ph('PadrÃµes Infecciosos','Diferencial de ConsolidaÃ§Ã£o','Conduta')},
  {id:'r-tx-4',spec:'torax',sub2:'InfecÃ§Ã£o/Pneumonia',name:'[COVID-19 â€” Achados TC]',sub:'TÃ³rax Â· InfecÃ§Ã£o',tags:['TC'],body:ph('Vidro Fosco e ConsolidaÃ§Ã£o','Diferencial','Escore CO-RADS')},
  {id:'r-tx-5',spec:'torax',sub2:'InterstÃ­cio/Fibrose',name:'[DoenÃ§as Intersticiais â€” ClassificaÃ§Ã£o]',sub:'TÃ³rax Â· InterstÃ­cio',tags:['TC'],body:ph('DRPI â€” PadrÃµes na TCAR','Diferencial UIP/NSIP/HP','Conduta Multidisciplinar')},
  {id:'r-tx-6',spec:'torax',sub2:'DPOC/Enfisema',name:'[DPOC â€” Achados na TC]',sub:'TÃ³rax Â· DPOC',tags:['TC'],body:ph('Enfisema e Aprisionamento AÃ©reo','Diferencial','Estadiamento')},
  {id:'r-tx-7',spec:'torax',sub2:'Derrame Pleural/Empiema',name:'[Derrame Pleural â€” TC e US]',sub:'TÃ³rax Â· Pleura',tags:['TC','US'],body:ph('Achados no US e TC','Transudato x Exsudato','Conduta')},
  {id:'r-tx-8',spec:'torax',sub2:'Mediastino',name:'[Massas Mediastinais]',sub:'TÃ³rax Â· Mediastino',tags:['TC','RM'],body:ph('Compartimentos do Mediastino','Diferencial por LocalizaÃ§Ã£o','Conduta')},
  {id:'r-tx-9',spec:'torax',sub2:'NÃ³dulo/Massa Pulmonar',name:'[CÃ¢ncer de PulmÃ£o â€” Estadiamento]',sub:'TÃ³rax Â· Neoplasia',tags:['TC','PET'],body:ph('TNM 8Âª ediÃ§Ã£o','Estadiamento TC e PET','Conduta Multidisciplinar')},
  {id:'r-tx-10',spec:'torax',sub2:'Trauma TorÃ¡cico',name:'[Trauma TorÃ¡cico â€” TC]',sub:'TÃ³rax Â· Trauma',tags:['TC'],body:ph('Achados no TC Trauma','Diferencial','Conduta Urgente')},
  {id:'r-us-abd-1',spec:'us',sub2:'Abdome Geral',name:'[Protocolo US Abdome Total]',sub:'US Â· Abdome Geral',tags:['US'],body:ph()},
  {id:'r-us-abd-2',spec:'us',sub2:'Abdome Geral',name:'[Abdome Agudo â€” US]',sub:'US Â· Abdome Geral',tags:['US'],body:ph()},
  {id:'r-us-tir-1',spec:'us',sub2:'Cervical/Tireoide',name:'[NÃ³dulo Tireoidiano â€” US]',sub:'US Â· Cervical/Tireoide',tags:['US'],body:ph()},
  {id:'r-us-tir-2',spec:'us',sub2:'Cervical/Tireoide',name:'[Tireoidite â€” US]',sub:'US Â· Cervical/Tireoide',tags:['US'],body:ph()},
  {id:'r-us-gin-1',spec:'us',sub2:'Ginecologia',name:'[US PÃ©lvico Transvaginal]',sub:'US Â· Ginecologia',tags:['US'],body:ph()},
  {id:'r-us-gin-2',spec:'us',sub2:'Ginecologia',name:'[NÃ³dulo Endometrial â€” US]',sub:'US Â· Ginecologia',tags:['US'],body:ph()},
  {id:'r-us-obs-1',spec:'us',sub2:'ObstetrÃ­cia',name:'[US MorfolÃ³gico 1Âº Trimestre]',sub:'US Â· ObstetrÃ­cia',tags:['US'],body:ph()},
  {id:'r-us-obs-2',spec:'us',sub2:'ObstetrÃ­cia',name:'[US MorfolÃ³gico 2Âº Trimestre]',sub:'US Â· ObstetrÃ­cia',tags:['US'],body:ph()},
  {id:'r-us-dop-1',spec:'us',sub2:'Doppler',name:'[Doppler Renal â€” Protocolo]',sub:'US Â· Doppler',tags:['US'],body:ph()},
  {id:'r-us-dop-2',spec:'us',sub2:'Doppler',name:'[Doppler Venoso MMII]',sub:'US Â· Doppler',tags:['US'],body:ph()},
  {id:'r-us-msk-1',spec:'us',sub2:'MÃºsculo-esquelÃ©tico US',name:'[Ombro â€” US]',sub:'US Â· MSK',tags:['US'],body:ph()},
  {id:'r-us-msk-2',spec:'us',sub2:'MÃºsculo-esquelÃ©tico US',name:'[Cotovelo â€” US]',sub:'US Â· MSK',tags:['US'],body:ph()},
  {id:'r-us-rin-1',spec:'us',sub2:'Rins/Vias/PrÃ³stata',name:'[CÃ³lica Renal â€” US]',sub:'US Â· Rins/Vias',tags:['US'],body:ph()},
  {id:'r-us-rin-2',spec:'us',sub2:'Rins/Vias/PrÃ³stata',name:'[PrÃ³stata â€” US Transretal]',sub:'US Â· PrÃ³stata',tags:['US'],body:ph()},
  {id:'r-us-tes-1',spec:'us',sub2:'TestÃ­culo/PÃªnis',name:'[TestÃ­culo â€” Protocolo US]',sub:'US Â· TestÃ­culo',tags:['US'],body:ph()},
  {id:'r-us-tor-1',spec:'us',sub2:'TÃ³rax US',name:'[Derrame Pleural â€” US]',sub:'US Â· TÃ³rax',tags:['US'],body:ph()},
  {id:'r-us-tor-2',spec:'us',sub2:'TÃ³rax US',name:'[PneumotÃ³rax â€” BLUE Protocol]',sub:'US Â· TÃ³rax',tags:['US'],body:ph()},
  {id:'r-us-olho-1',spec:'us',sub2:'Globo Ocular',name:'[Globo Ocular â€” Protocolo US]',sub:'US Â· Globo Ocular',tags:['US'],body:ph()},
  {id:'r-us-tf-1',spec:'us',sub2:'Transfontanelar',name:'[Transfontanelar â€” RecÃ©m-nato]',sub:'US Â· Transfontanelar',tags:['US'],body:ph()},
  {id:'r-us-tf-2',spec:'us',sub2:'Transfontanelar',name:'[Hemorragia Peri-intraventricular]',sub:'US Â· Transfontanelar Â· Pediatria',tags:['US'],body:ph()},
  {id:'r-us-ped-1',spec:'us',sub2:'Pediatria US',name:'[ApÃªndice em CrianÃ§a â€” US]',sub:'US Â· Pediatria',tags:['US'],body:ph()},
  {id:'r-us-ped-2',spec:'us',sub2:'Pediatria US',name:'[IntussuscepÃ§Ã£o â€” US]',sub:'US Â· Pediatria',tags:['US'],body:ph()},
  {id:'r-us-ped-3',spec:'us',sub2:'Pediatria US',name:'[Displasia do Desenvolvimento do Quadril]',sub:'US Â· Pediatria',tags:['US'],body:ph()},
  {id:'r-us-ped-4',spec:'us',sub2:'Pediatria US',name:'[Estenose PilÃ³rica HipertrÃ³fica]',sub:'US Â· Pediatria',tags:['US'],body:ph()},
  {id:'r-us-proc-1',spec:'us',sub2:'Procedimentos US',name:'[BiÃ³psia Guiada por US]',sub:'US Â· Procedimentos',tags:['US'],body:ph()},
];

const DA=[
  {id:'a-neuro-1',spec:'neuro',sub2:'EncÃ©falo',name:'[TÃ­tulo Artigo â€” Neuro 1]',journal:'Radiology Â· 2024',author:'Autor et al.',tags:['RM'],
   img:'https://upload.wikimedia.org/wikipedia/commons/thumb/9/9f/MRI_brain_normal_axial_T1.jpg/320px-MRI_brain_normal_axial_T1.jpg',body:artPh()},
  {id:'a-neuro-2',spec:'neuro',sub2:'Vascular Cerebral',name:'[TÃ­tulo Artigo â€” Neuro 2]',journal:'AJNR Â· 2024',author:'Autor et al.',tags:['TC'],body:artPh()},
  {id:'a-cn-1',spec:'cn',sub2:'Tireoide/Paratireoide',name:'[TÃ­tulo Artigo â€” Tireoide 1]',journal:'Eur Radiol Â· 2024',author:'Autor et al.',tags:['US'],
   img:'https://upload.wikimedia.org/wikipedia/commons/thumb/9/9e/Thyroid_ultrasound.jpg/320px-Thyroid_ultrasound.jpg',body:artPh()},
  {id:'a-cn-2',spec:'cn',sub2:'Laringe/Faringe',name:'[TÃ­tulo Artigo â€” C&P 2]',journal:'AJNR Â· 2023',author:'Autor et al.',tags:['TC','RM'],body:artPh()},
  {id:'a-gi-1',spec:'gi',sub2:'FÃ­gado',name:'[TÃ­tulo Artigo â€” FÃ­gado 1]',journal:'Radiology Â· 2024',author:'Autor et al.',tags:['RM'],
   img:'https://upload.wikimedia.org/wikipedia/commons/thumb/1/1c/Hepatocellular_carcinoma_CT.jpg/320px-Hepatocellular_carcinoma_CT.jpg',body:artPh()},
  {id:'a-gi-2',spec:'gi',sub2:'PÃ¢ncreas',name:'[TÃ­tulo Artigo â€” PÃ¢ncreas 1]',journal:'Eur Radiol Â· 2023',author:'Autor et al.',tags:['TC'],body:artPh()},
  {id:'a-gu-1',spec:'gu',sub2:'Rins',name:'[TÃ­tulo Artigo â€” Rins 1]',journal:'Radiology Â· 2024',author:'Autor et al.',tags:['TC','RM'],body:artPh()},
  {id:'a-gu-2',spec:'gu',sub2:'Adrenal',name:'[TÃ­tulo Artigo â€” Adrenal 1]',journal:'AJR Â· 2024',author:'Autor et al.',tags:['TC'],body:artPh()},
  {id:'a-msk-1',spec:'msk',sub2:'Ombro',name:'[TÃ­tulo Artigo â€” MSK Ombro 1]',journal:'Eur Radiol Â· 2024',author:'Autor et al.',tags:['RM'],
   img:'https://upload.wikimedia.org/wikipedia/commons/thumb/a/a0/MRI_shoulder.jpg/320px-MRI_shoulder.jpg',body:artPh()},
  {id:'a-msk-2',spec:'msk',sub2:'Joelho',name:'[TÃ­tulo Artigo â€” MSK Joelho 1]',journal:'Radiology Â· 2023',author:'Autor et al.',tags:['RM'],body:artPh()},
  {id:'a-mama-1',spec:'mama',sub2:'US Mama',name:'[TÃ­tulo Artigo â€” Mama US 1]',journal:'Radiology Â· 2024',author:'Autor et al.',tags:['US'],body:artPh()},
  {id:'a-mama-2',spec:'mama',sub2:'Mamografia',name:'[TÃ­tulo Artigo â€” Mama MG 1]',journal:'NEJM Â· 2024',author:'Autor et al.',tags:['RX'],body:artPh()},
  {id:'a-vasc-1',spec:'vasc',sub2:'Veias/TEP',name:'[TÃ­tulo Artigo â€” TEP 1]',journal:'Chest Â· 2024',author:'Autor et al.',tags:['TC'],
   img:'https://upload.wikimedia.org/wikipedia/commons/thumb/6/62/Pulmonary_embolism_CT.jpg/320px-Pulmonary_embolism_CT.jpg',body:artPh()},
  {id:'a-vasc-2',spec:'vasc',sub2:'Aorta TorÃ¡cica',name:'[TÃ­tulo Artigo â€” Aorta 1]',journal:'Eur Heart J Â· 2024',author:'Autor et al.',tags:['TC'],body:artPh()},
  // TÃ“RAX
  {id:'a-tx-1',spec:'torax',sub2:'NÃ³dulo/Massa Pulmonar',name:'[TÃ­tulo Artigo â€” NÃ³dulo Pulmonar]',journal:'Radiology Â· 2024',author:'Autor et al.',tags:['TC'],
   img:'https://upload.wikimedia.org/wikipedia/commons/thumb/f/f8/Chest_CT_scan.jpg/320px-Chest_CT_scan.jpg',body:artPh()},
  {id:'a-tx-2',spec:'torax',sub2:'InterstÃ­cio/Fibrose',name:'[TÃ­tulo Artigo â€” DoenÃ§as Intersticiais]',journal:'AJRCCM Â· 2024',author:'Autor et al.',tags:['TC'],body:artPh()},
  {id:'a-tx-3',spec:'torax',sub2:'InfecÃ§Ã£o/Pneumonia',name:'[TÃ­tulo Artigo â€” Pneumonia AtÃ­pica TC]',journal:'Eur Radiol Â· 2023',author:'Autor et al.',tags:['TC','RX'],body:artPh()},
  {id:'a-tx-4',spec:'torax',sub2:'Mediastino',name:'[TÃ­tulo Artigo â€” Massas Mediastinais]',journal:'AJR Â· 2024',author:'Autor et al.',tags:['TC','RM'],body:artPh()},
  // US
  {id:'a-us-1',spec:'us',sub2:'Abdome Geral',name:'[TÃ­tulo Artigo â€” US Abdome 1]',journal:'Ultrasound Med Â· 2024',author:'Autor et al.',tags:['US'],body:artPh()},
  {id:'a-us-2',spec:'us',sub2:'Doppler',name:'[TÃ­tulo Artigo â€” Doppler 1]',journal:'Eur Radiol Â· 2024',author:'Autor et al.',tags:['US'],body:artPh()},
  {id:'a-us-3',spec:'us',sub2:'Pediatria US',name:'[TÃ­tulo Artigo â€” Pediatria US 1]',journal:'Pediatr Radiol Â· 2024',author:'Autor et al.',tags:['US'],body:artPh()},
  {id:'a-us-4',spec:'us',sub2:'ObstetrÃ­cia',name:'[TÃ­tulo Artigo â€” ObstÃ©trico 1]',journal:'Ultrasound Obstet Â· 2024',author:'Autor et al.',tags:['US'],body:artPh()},
];

const DC=[
  {id:'egfr',spec:'contraste',sub2:'Iodado',name:'eGFR â€” CKD-EPI 2021',sub:'FiltraÃ§Ã£o glomerular estimada',tags:['Calc'],body:`<p style="font-size:0.76rem;color:var(--text3);margin-bottom:1rem">CKD-EPI 2021 Â· Sem variÃ¡vel raÃ§a</p><div class="row3"><div><label class="f">Creatinina (mg/dL)</label><input class="fi" type="number" id="c-cr" step="0.01" placeholder="0.90"></div><div><label class="f">Idade</label><input class="fi" type="number" id="c-age" placeholder="45"></div><div><label class="f">Sexo</label><select class="fi" id="c-sex"><option value="F">Feminino</option><option value="M">Masculino</option></select></div></div><button class="calc-btn" onclick="calcEGFR()">Calcular eGFR</button><div class="res-box" id="r-egfr"><div class="res-lbl">eGFR estimado</div><div class="res-num" id="rv-egfr">â€”</div><div class="res-unit">mL/min/1,73 mÂ²</div><div class="res-badge" id="rb-egfr"></div><div class="pd"></div><div class="res-note" id="rn-egfr"></div></div>`},
  {id:'tirads-calc',spec:'cn',sub2:'Tireoide/Paratireoide',name:'TI-RADS â€” ACR 2017',sub:'PontuaÃ§Ã£o nÃ³dulos tireoidianos',tags:['Calc','US'],body:`<div class="tirads-g"><div><p style="font-size:0.66rem;color:var(--text3);text-transform:uppercase;letter-spacing:0.07em;margin-bottom:0.45rem">ComposiÃ§Ã£o</p><div class="pill-group"><input type="radio" class="pill-r" name="tc" id="tc0" value="0"><label class="pill-l" for="tc0">CÃ­stica (0)</label><input type="radio" class="pill-r" name="tc" id="tc1" value="1"><label class="pill-l" for="tc1">Mista (1)</label><input type="radio" class="pill-r" name="tc" id="tc2" value="2"><label class="pill-l" for="tc2">SÃ³lida (2)</label></div></div><div><p style="font-size:0.66rem;color:var(--text3);text-transform:uppercase;letter-spacing:0.07em;margin-bottom:0.45rem">Ecogenicidade</p><div class="pill-group"><input type="radio" class="pill-r" name="teco" id="te0" value="0"><label class="pill-l" for="te0">AnecÃ³ica (0)</label><input type="radio" class="pill-r" name="teco" id="te1" value="1"><label class="pill-l" for="te1">Hiper (1)</label><input type="radio" class="pill-r" name="teco" id="te2" value="2"><label class="pill-l" for="te2">Iso/hipo (2)</label><input type="radio" class="pill-r" name="teco" id="te3" value="3"><label class="pill-l" for="te3">Muito hipo (3)</label></div></div><div><p style="font-size:0.66rem;color:var(--text3);text-transform:uppercase;letter-spacing:0.07em;margin-bottom:0.45rem">Forma</p><div class="pill-group"><input type="radio" class="pill-r" name="tf" id="tf0" value="0"><label class="pill-l" for="tf0">Larga&gt;alta (0)</label><input type="radio" class="pill-r" name="tf" id="tf3" value="3"><label class="pill-l" for="tf3">Alta&gt;larga (3)</label></div></div><div><p style="font-size:0.66rem;color:var(--text3);text-transform:uppercase;letter-spacing:0.07em;margin-bottom:0.45rem">Margens</p><div class="pill-group"><input type="radio" class="pill-r" name="tm" id="tm0" value="0"><label class="pill-l" for="tm0">Lisas (0)</label><input type="radio" class="pill-r" name="tm" id="tm2" value="2"><label class="pill-l" for="tm2">Mal def. (2)</label><input type="radio" class="pill-r" name="tm" id="tm3" value="3"><label class="pill-l" for="tm3">Irregulares (3)</label></div></div><div style="grid-column:1/-1"><p style="font-size:0.66rem;color:var(--text3);text-transform:uppercase;letter-spacing:0.07em;margin-bottom:0.45rem">Focos EcogÃªnicos</p><div class="pill-group"><input type="checkbox" class="pill-c" id="tfe0" value="0"><label class="pill-l" for="tfe0">Nenhum (0)</label><input type="checkbox" class="pill-c" id="tfe1" value="1"><label class="pill-l" for="tfe1">Macrocalcif. (1)</label><input type="checkbox" class="pill-c" id="tfe2" value="2"><label class="pill-l" for="tfe2">Calcif. perifÃ©rica (2)</label><input type="checkbox" class="pill-c" id="tfe3" value="3"><label class="pill-l" for="tfe3">Puntiformes (3)</label></div></div></div><div style="margin-top:0.7rem"><label class="f">Maior diÃ¢metro (cm)</label><input class="fi" type="number" id="t-sz" step="0.1" placeholder="1.5" style="max-width:140px"></div><button class="calc-btn" onclick="calcTIRADS()">Calcular TI-RADS</button><div class="res-box" id="r-tirads"><div class="res-lbl">PontuaÃ§Ã£o</div><div class="res-num" id="rv-tirads">â€”</div><div class="res-badge" id="rb-tirads"></div><div class="pd"></div><div class="res-note" id="rn-tirads"></div></div>`},
  {id:'contraste-dose',spec:'contraste',sub2:'Iodado',name:'Dose de Contraste Iodado',sub:'CÃ¡lculo por peso + alerta renal',tags:['Calc'],body:`<div class="row3"><div><label class="f">Peso (kg)</label><input class="fi" type="number" id="c-w" placeholder="70"></div><div><label class="f">ConcentraÃ§Ã£o</label><select class="fi" id="c-conc"><option value="300">300 mgI/mL</option><option value="320">320 mgI/mL</option><option value="350" selected>350 mgI/mL</option><option value="370">370 mgI/mL</option><option value="400">400 mgI/mL</option></select></div><div><label class="f">eGFR (opcional)</label><input class="fi" type="number" id="c-eg" placeholder="90"></div></div><button class="calc-btn" onclick="calcContraste()">Calcular dose</button><div class="res-box" id="r-ct"><div class="row2"><div><div class="res-lbl">Dose recomendada</div><div class="res-num" id="rv-ct">â€”</div><div class="res-unit">mL</div></div><div><div class="res-lbl">Dose mÃ¡xima</div><div class="res-num" id="rv-ctmax" style="color:var(--orange)">â€”</div><div class="res-unit">mL</div></div></div><div class="res-badge" id="rb-ct" style="margin-top:0.65rem"></div><div class="pd"></div><div class="res-note" id="rn-ct"></div></div>`},
  {id:'birads-calc',spec:'mama',sub2:'US Mama',name:'BI-RADS â€” Ultrassom',sub:'ACR BI-RADS 5Âª ediÃ§Ã£o',tags:['Calc','US'],body:`<div class="row2"><div><label class="f">Forma</label><select class="fi" id="bi-f"><option value="0">Oval (0)</option><option value="1">Redonda (1)</option><option value="2">Irregular (2)</option></select></div><div><label class="f">OrientaÃ§Ã£o</label><select class="fi" id="bi-o"><option value="0">Paralela (0)</option><option value="2">NÃ£o paralela (2)</option></select></div></div><div class="row2"><div><label class="f">Margem</label><select class="fi" id="bi-m"><option value="0">Circunscrita (0)</option><option value="2">NÃ£o circunscrita (2)</option></select></div><div><label class="f">PadrÃ£o ecogÃªnico</label><select class="fi" id="bi-e"><option value="0">Anecoico/hiper (0)</option><option value="1">IsoecÃ³ico (1)</option><option value="2">HipoecÃ³ico (2)</option><option value="3">Muito hipo (3)</option></select></div></div><div class="row2"><div><label class="f">CaracterÃ­sticas posteriores</label><select class="fi" id="bi-p"><option value="0">Sem/reforÃ§o (0)</option><option value="1">AtenuaÃ§Ã£o (1)</option></select></div><div><label class="f">CalcificaÃ§Ãµes</label><select class="fi" id="bi-c"><option value="0">Ausentes (0)</option><option value="1">MacrocalcificaÃ§Ãµes (1)</option><option value="2">Microcalc. suspeitas (2)</option></select></div></div><button class="calc-btn" onclick="calcBIRADS()">Calcular BI-RADS</button><div class="res-box" id="r-bi"><div class="res-lbl">Categoria</div><div class="res-num" id="rv-bi">â€”</div><div class="res-badge" id="rb-bi"></div><div class="pd"></div><div class="res-note" id="rn-bi"></div></div>`},
  {id:'bosniak-calc',spec:'gu',sub2:'Rins',name:'Bosniak 2019',sub:'Massas renais cÃ­sticas',tags:['Calc'],body:`<label class="f">CaracterÃ­sticas da massa</label><select class="fi" id="bos-cat" onchange="calcBosniak()"><option value="">â€” Selecione â€”</option><option value="1">Cisto simples Â· sem septos Â· sem calcificaÃ§Ã£o (Bosniak I)</option><option value="2">Minimamente complexo Â· septos finos Â· sem realce (Bosniak II)</option><option value="2f">Septos mÃºltiplos ou espessamento leve Â· sem realce de partes moles (Bosniak IIF)</option><option value="3">Parede ou septos espessados com realce irregular (Bosniak III)</option><option value="4">Componente sÃ³lido com realce (Bosniak IV)</option></select><div class="res-box" id="r-bos"><div class="res-badge" id="rb-bos" style="font-size:0.88rem;padding:0.38rem 1rem"></div><div class="pd"></div><div class="res-note" id="rn-bos"></div></div>`},
];

const DG=[
  {id:'rm-cardiaca',spec:'vasc',sub2:'IntervenÃ§Ã£o Arterial',name:'RM CardÃ­aca',sub:'FunÃ§Ã£o biventricular Â· Mapas Â· Realce tardio',tags:['RM'],body:`<div style="text-align:center;padding:2rem 1rem"><div style="font-size:3rem;margin-bottom:1rem">ğŸ«€</div><p style="font-size:0.87rem;color:var(--text2);line-height:1.7;margin-bottom:1.4rem">Gerador completo com duas mÃ¡scaras de laudo, cÃ¡lculo automÃ¡tico de volumes e FE, mapas paramÃ©tricos (T1, T2, T2*), ECV e realce tardio.</p><button class="calc-btn" style="margin:0 auto" onclick="openRMCardiaca()">Abrir Gerador â†’</button></div>`},
];

// ============================================
// DATA - TEMPLATES (from Supabase)
// ============================================
let DT=[];

// ============================================
// DATA - FRASES (from Supabase)
// ============================================
let DF=[];

// ============================================
// DATA - CHECKLISTS (from Supabase)
// ============================================
let DCK=[];

const UPDATES=[
  {date:'11 Fev',badge:'ub-r',type:'v3.1',text:'<strong>RadioHub v3.1</strong> â€” TÃ³rax adicionado, filtros horizontais, subÃ¡reas, painel 72%, imagens nos cards.'},
  {date:'11 Fev',badge:'ub-r',type:'Artigos',text:'<strong>Resumo de Artigos</strong> â€” Nova seÃ§Ã£o com take-aways prÃ¡ticos. TÃ³rax, Neuro, GI, MSK e mais.'},
  {date:'10 Fev',badge:'ub-c',type:'Calc',text:'<strong>Bosniak 2019 Â· BI-RADS Â· TI-RADS Â· eGFR Â· Contraste</strong> â€” 5 calculadoras ativas.'},
  {date:'10 Fev',badge:'ub-g',type:'Gerador',text:'<strong>RM CardÃ­aca</strong> â€” Gerador integrado, abre em tela cheia.'},
];

const SECS=['resumos','artigos','calc','geradores','templates','frases','checklist'];
let CSPEC={};SECS.forEach(s=>CSPEC[s]='all');
let CSUB2={};SECS.forEach(s=>CSUB2[s]='all');

// DADOS DO FIREBASE (carregados dinamicamente)
let FIREBASE_RESUMOS = [];
let FIREBASE_FRASES = [];
let FIREBASE_TEMPLATES = [];
let FIREBASE_CHECKLISTS = [];

// CARREGA DADOS DO FIREBASE
async function carregarDadosFirebase() {
  try {
    // Espera as funÃ§Ãµes Firebase estarem disponÃ­veis
    let attempts = 0;
    while (!window.loadFirebaseResumos && attempts < 50) {
      await new Promise(resolve => setTimeout(resolve, 100));
      attempts++;
    }
    
    if (!window.loadFirebaseResumos) {
      console.error('âŒ FunÃ§Ãµes Firebase nÃ£o carregaram');
      return;
    }
    
    console.log('ğŸ”¥ Carregando dados do Firebase...');
    
    // Carrega resumos
    const resumos = await window.loadFirebaseResumos();
    FIREBASE_RESUMOS = resumos.map(r => ({
      id: r.id,
      spec: r.spec || 'geral',
      sub2: r.spec || 'Geral',
      name: r.titulo || 'Sem tÃ­tulo',
      sub: `${r.spec} Â· ${r.titulo}`,
      tags: r.tags || [],
      body: r.body || r.texto || '<p>ConteÃºdo nÃ£o disponÃ­vel</p>',
      img: '' // Firebase nÃ£o tem imagens por enquanto
    }));
    
    // Carrega frases
    const frases = await window.loadFirebaseFrases();
    FIREBASE_FRASES = frases.map(f => ({
      id: f.id,
      spec: 'geral', // Default spec
      sub2: f.categoria || 'Sem categoria',
      text: f.texto || '',
      tags: []
    }));
    
    // Carrega templates
    const templates = await window.loadFirebaseTemplates();
    FIREBASE_TEMPLATES = templates.map(t => ({
      id: t.id,
      spec: t.especialidade || 'geral',
      sub2: 'Template',
      name: t.nome || 'Sem nome',
      sub: `Template Â· ${t.nome || 'Sem nome'}`,
      tags: [],
      txt: t.texto || ''
    }));
    
    // Carrega checklists  
    const checklists = await window.loadFirebaseChecklists();
    FIREBASE_CHECKLISTS = checklists.map(c => ({
      id: c.id,
      spec: 'geral',
      sub2: c.exame || 'Checklist',
      name: c.nome || 'Sem nome',
      sub: `${c.exame || 'Checklist'} Â· ${c.nome || 'Sem nome'}`,
      tags: [],
      itens: c.itens || []
    }));
    
    console.log(`âœ… Firebase carregado! ${FIREBASE_RESUMOS.length} resumos, ${FIREBASE_FRASES.length} frases, ${FIREBASE_TEMPLATES.length} templates, ${FIREBASE_CHECKLISTS.length} checklists`);
    
    // Recarrega a seÃ§Ã£o atual se for resumos/frases/templates/checklist
    const currentSection = document.querySelector('.section.active');
    if (currentSection) {
      const sid = currentSection.id;
      if (['resumos', 'frases', 'templates', 'checklist'].includes(sid)) {
        _0x3e4f(sid);
      }
    }
    
  } catch (error) {
    console.error('âŒ Erro ao carregar Firebase:', error);
  }
}

function getData(sid){
  // Se tiver dados do Firebase, usa eles; senÃ£o usa os mock
  if (sid === 'resumos' && FIREBASE_RESUMOS.length > 0) return [...DR, ...FIREBASE_RESUMOS];
  if (sid === 'frases' && FIREBASE_FRASES.length > 0) return [...DF, ...FIREBASE_FRASES];
  if (sid === 'templates' && FIREBASE_TEMPLATES.length > 0) return [...DT, ...FIREBASE_TEMPLATES];
  if (sid === 'checklist' && FIREBASE_CHECKLISTS.length > 0) return [...DCK, ...FIREBASE_CHECKLISTS];
  
  return {resumos:DR,artigos:DA,calc:DC,geradores:DG,templates:DT,frases:DF,checklist:DCK}[sid]||[];
}

function _0x7i8j(id,btn){
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.querySelectorAll('.mnb').forEach(b=>b.classList.remove('active'));
  const sec=document.getElementById(id);
  if(sec)sec.classList.add('active');
  if(btn)btn.classList.add('active');
  const showBars=SECS.includes(id);
  document.getElementById('hdr2').classList.toggle('visible',showBars);
  _0xa1b2();
  document.getElementById('app').style.marginTop=showBars?'90px':'50px';
  document.getElementById('slide-panel').style.top=showBars?'90px':'50px';
  if(showBars){syncSpecBtns(CSPEC[id]||'all');_0x3e4f(id);}
  _0x6h7i();
}

function setSpec(spec,btn){
  const sid=document.querySelector('.section.active')?.id;
  if(!sid)return;
  // toggle: se jÃ¡ estÃ¡ aberto para esta spec, fecha
  const dd=document.getElementById('sub-dropdown');
  const prevSpec=dd.dataset.spec;
  _0xa1b2();
  if(prevSpec===spec && dd.dataset.wasOpen==='1'){
    // sÃ³ fecha, nÃ£o reabre
    CSPEC[sid]=spec;CSUB2[sid]='all';
    syncSpecBtns(spec);_0x3e4f(sid);
    return;
  }
  CSPEC[sid]=spec;CSUB2[sid]='all';
  syncSpecBtns(spec);
  buildDropdown(spec,btn,sid);
  _0x3e4f(sid);
}
function syncSpecBtns(spec){
  document.querySelectorAll('#hdr2 .spb').forEach(b=>{
    b.classList.toggle('active',b.dataset.spec===spec);
    b.classList.remove('has-sub');
  });
  if(spec!=='all'){
    const active=document.querySelector(`#hdr2 .spb[data-spec="${spec}"]`);
    if(active&&SPECS[spec]?.subs?.length)active.classList.add('has-sub');
  }
}
function buildDropdown(spec,btn,sid){
  const dd=document.getElementById('sub-dropdown');
  const subs=SPECS[spec]?.subs||[];
  if(!subs.length){dd.dataset.spec='';dd.dataset.wasOpen='0';return;}
  // posiciona sob o botÃ£o
  const rect=btn.getBoundingClientRect();
  dd.style.top=(rect.bottom+5)+'px';
  dd.style.left=Math.max(8,rect.left)+'px';
  // conteÃºdo
  document.getElementById('sub-dropdown-title').textContent=SPECS[spec].label;
  // remove botÃµes antigos mas mantÃ©m title
  dd.querySelectorAll('.subb').forEach(b=>b.remove());
  const title=dd.querySelector('.sub-dropdown-title');
  // botÃ£o "Todas"
  const allBtn=document.createElement('button');
  allBtn.className='subb all-sub active';allBtn.dataset.sub='all';
  allBtn.textContent='âŠ• Todas';
  allBtn.onclick=()=>setSub2('all',allBtn,sid);
  title.after(allBtn);
  // botÃµes de subÃ¡rea
  let prev=allBtn;
  subs.forEach(s=>{
    const b=document.createElement('button');
    b.className='subb';b.dataset.sub=s;b.textContent=s;
    b.onclick=()=>setSub2(s,b,sid);
    prev.after(b);prev=b;
  });
  dd.dataset.spec=spec;dd.dataset.wasOpen='1';
  dd.classList.add('open');
}
function _0xa1b2(){
  const dd=document.getElementById('sub-dropdown');
  dd.classList.remove('open');
  dd.dataset.wasOpen='0';
  document.querySelectorAll('#hdr2 .spb').forEach(b=>b.classList.remove('has-sub'));
}
function setSub2(sub,btn,sid){
  CSUB2[sid]=sub;
  document.querySelectorAll('#sub-dropdown .subb').forEach(b=>b.classList.remove('active'));
  if(btn)btn.classList.add('active');
  _0x3e4f(sid);
}

function _0x4f5g(sid,q){_0x3e4f(sid,q);}
function _0x3e4f(sid,q=''){
  const data=getData(sid);
  const spec=CSPEC[sid]||'all';
  const sub2=CSUB2[sid]||'all';
  const lq=q.toLowerCase();
  const filtered=data.filter(item=>{
    const ms=spec==='all'||item.spec===spec;
    const ms2=sub2==='all'||item.sub2===sub2;
    const mq=!lq||item.name.toLowerCase().includes(lq)||(item.sub||'').toLowerCase().includes(lq)||(item.tags||[]).some(t=>t.toLowerCase().includes(lq))||(item.journal||'').toLowerCase().includes(lq);
    return ms&&ms2&&mq;
  });
  const grid=document.getElementById('grid-'+sid);
  if(!grid)return;
  if(!filtered.length){grid.innerHTML=`<div class="empty"><div class="empty-icon">ğŸ”</div>Nenhum resultado</div>`;return;}
  if(sid==='artigos'){
    grid.innerHTML=filtered.map(item=>`<div class="artigo-card" onclick="_0x5g6h('artigos','${item.id}')">
      ${item.img?`<img class="artigo-thumb" src="${item.img}" alt="" loading="lazy" onerror="this.style.display='none'">`:'' }
      <div class="artigo-journal">${item.journal||''}</div>
      <div class="artigo-title">${item.name}</div>
      <div class="artigo-meta">${item.author||''} Â· ${item.sub2||''}</div>
      <div class="ic-tags">${(item.tags||[]).map(t=>`<span class="ic-tag t-${t.toLowerCase()}">${t}</span>`).join('')}</div>
    </div>`).join('');
  } else if(sid==='frases'){
    grid.innerHTML=filtered.map(item=>{
      const si=SPECS[item.spec]||{};
      const tags=(item.tags||[]).map(t=>`<span class="ic-tag t-${t.toLowerCase()}">${t}</span>`).join('');
      const hasRef=item.rid||item.artid;
      let refBtn='';
      if(hasRef){
        const refType=item.rid?'resumo':'artigo';
        refBtn=`<button class="frase-mini-btn ref" title="Abrir ${refType} em nova janela" onclick="event.stopPropagation();fraseGoRef('${item.id}',true)">
          <span style="font-size:0.65rem">ğŸ”—</span>
          <span style="font-size:0.62rem;opacity:0.85">${refType}</span>
        </button>`;
      }
      const expandBtn=`<button class="frase-mini-btn" title="Expandir" onclick="event.stopPropagation();openFraseModal('${item.id}')">â¤¢</button>`;
      return`<div class="frase-card">
        <div class="frase-card-top">
          <div><div class="frase-card-spec">${si.icon||''} ${si.label||item.spec}</div><div class="frase-card-sub2">â†³ ${item.sub2||''}</div></div>
          <div class="frase-card-actions">${refBtn}${expandBtn}</div>
        </div>
        <div class="frase-text" title="Clique para copiar" onclick="fraseInlineCopy(this,${JSON.stringify(item.text||'')})">${item.text||''}</div>
        <div class="frase-tags" style="margin-top:0.42rem">${tags}</div>
      </div>`;
    }).join('');
  } else {
    grid.innerHTML=filtered.map(item=>{
      const si=SPECS[item.spec]||{};
      const tags=(item.tags||[]).map(t=>`<span class="ic-tag t-${t.toLowerCase()}">${t}</span>`).join('');
      const s2=item.sub2?`<div class="ic-sub2">â†³ ${item.sub2}</div>`:'';
      const thumb=item.img?`<img class="ic-thumb" src="${item.img}" alt="" loading="lazy" onerror="this.style.display='none'">`:'' ;
      return`<div class="item-card" onclick="_0x5g6h('${sid}','${item.id}')">
        ${thumb}
        <div class="ic-spec">${si.icon||''} ${si.label||item.spec}</div>
        <div class="ic-name">${item.name}</div>
        ${item.sub?`<div class="ic-sub">${item.sub}</div>`:''}${s2}
        <div class="ic-tags">${tags}</div>
      </div>`;
    }).join('');
  }
}

function _0x5g6h(sid,itemId){
  const data=getData(sid);
  const item=data.find(i=>i.id===itemId);if(!item)return;
  const si=SPECS[item.spec]||{};
  document.getElementById('panel-spec-badge').textContent=(si.icon||'')+' '+(si.label||item.spec)+(item.sub2?' Â· '+item.sub2:'');
  document.getElementById('panel-title').textContent=item.name;
  document.getElementById('panel-tags').innerHTML=(item.tags||[]).map(t=>`<span class="ic-tag t-${t.toLowerCase()}">${t}</span>`).join('');
  let body='';
  if(sid==='resumos'||sid==='calc'||sid==='geradores')body=item.body||'';
  else if(sid==='artigos')body=item.body||'';
  else if(sid==='templates')body=buildTplPanel(item);
  else if(sid==='checklist')body=buildChkPanel(item);
  document.getElementById('panel-body').innerHTML=body;
  document.getElementById('slide-panel').classList.add('open');
  document.getElementById('panel-overlay').classList.add('open');
  document.getElementById('main-content').classList.add('panel-open');
}
function _0x6h7i(){
  document.getElementById('slide-panel').classList.remove('open');
  document.getElementById('panel-overlay').classList.remove('open');
  document.getElementById('main-content').classList.remove('panel-open');
}
function buildTplPanel(item){
  // Formata o template para ficar bonito e copiar bem pro Word
  let formatted = (item.t||'').trim();
  
  // Detecta a primeira linha como tÃ­tulo (geralmente em CAPS ou entre [ ])
  const lines = formatted.split('\n');
  if(lines.length > 0){
    const firstLine = lines[0].trim();
    // Se primeira linha Ã© tÃ­tulo (maiÃºsculas ou entre [])
    if(firstLine.toUpperCase()===firstLine || firstLine.match(/^\[.*\]$/)){
      formatted = `<div style="text-align:center;font-weight:700;font-size:1.1em;margin-bottom:1.5em;font-family:Arial,sans-serif;">${firstLine}</div>\n` + lines.slice(1).join('\n');
    }
  }
  
  // Adiciona negrito em seÃ§Ãµes (linhas que terminam com :)
  formatted = formatted.replace(/^([A-ZÃÃ€Ã‚ÃƒÃ‰ÃŠÃÃ“Ã”Ã•ÃšÃ‡][^\n:]{0,30}:)/gm, '<strong>$1</strong>');
  
  // Preserva quebras de linha e espaÃ§os
  formatted = formatted.replace(/\n/g, '<br>').replace(/  /g, '&nbsp;&nbsp;');
  
  return`
    <div style="margin-bottom:1rem;padding:1.5rem 2rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--r-sm);line-height:1.9;font-size:0.88rem;font-family:Arial,sans-serif;" id="tpl-display">${formatted}</div>
    <div style="display:none;"><textarea class="laudo-area" id="tpl-ta">${item.t||''}</textarea></div>
    <div>
      <button class="btn-ghost" onclick="copyTplFormatted()">ğŸ“‹ Copiar (Word)</button>
      <button class="btn-ghost" onclick="copyTplPlain()">ğŸ“„ Copiar Texto Simples</button>
    </div>
  `;
}
function copyTplFormatted(){
  // Copia HTML formatado (funciona no Word!)
  const html = document.getElementById('tpl-display').innerHTML;
  const text = document.getElementById('tpl-ta').value;
  
  const blob = new ClipboardItem({
    'text/html': new Blob([html], {type: 'text/html'}),
    'text/plain': new Blob([text], {type: 'text/plain'})
  });
  
  navigator.clipboard.write([blob]).then(()=>{
    toast('âœ“ MÃ¡scara copiada com formataÃ§Ã£o!');
  }).catch(()=>{
    // Fallback para texto simples
    navigator.clipboard.writeText(text);
    toast('âœ“ MÃ¡scara copiada (texto simples)');
  });
}
function copyTplPlain(){
  navigator.clipboard.writeText(document.getElementById('tpl-ta').value);
  toast('âœ“ Texto copiado!');
}
function buildChkPanel(item){
  return`
    <h3>Frase completa</h3>
    <p style="font-size:0.72rem;color:var(--text3);margin-bottom:0.6rem">Clique no texto para copiar</p>
    <div class="frase-full-text" title="Clique para copiar"
      onclick="fraseInlineCopy(this,${JSON.stringify(item.text||'')})">${item.text||''}</div>
    <button class="frase-copy-big" onclick="copyFrase(${JSON.stringify(item.text||'')})">ğŸ“‹ Copiar</button>
    ${refBtn}`;
}
function fraseInlineCopy(el,text){
  navigator.clipboard.writeText(text).then(()=>{
    el.classList.add('copied');
    setTimeout(()=>el.classList.remove('copied'),1200);
    toast('Frase copiada!');
  });
}
function fraseGoRef(itemId,newWindow){
  const item=DF.find(i=>i.id===itemId);if(!item)return;
  const targetId=item.rid||item.artid;
  const targetSec=item.rid?'resumos':'artigos';
  if(!targetId)return;
  if(newWindow){
    // abre em nova janela
    const w=window.open('','_blank','width=1200,height=800,scrollbars=yes,resizable=yes');
    if(!w)return;
    w.document.write(`<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Carregando...</title></head><body style="margin:0;padding:2rem;font-family:sans-serif;background:#0b0c10;color:#e2e5f0"><div style="text-align:center"><p>Carregando conteÃºdo...</p><p style="font-size:0.8rem;color:#8d94b0">Aguarde enquanto abrimos o ${item.rid?'resumo':'artigo'}.</p></div></body></html>`);
    w.document.close();
    // simula delay para dar tempo de criar o DOM
    setTimeout(()=>{
      w.location.href=window.location.href.split('?')[0].split('#')[0]+'?open='+targetSec+'&id='+targetId;
    },100);
  } else {
    // abre no painel atual
    _0xa1b2();_0x6h7i();
    _0x7i8j(targetSec,document.querySelectorAll('.mnb')[targetSec==='resumos'?1:2]);
    setTimeout(()=>_0x5g6h(targetSec,targetId),160);
  }
}
function openFraseModal(itemId){
  const item=DF.find(i=>i.id===itemId);if(!item)return;
  const si=SPECS[item.spec]||{};
  const hasRef=item.rid||item.artid;
  const refType=item.rid?'resumo':'artigo';
  const refBtn=hasRef?`<button class="frase-ref-big" onclick="fraseGoRef('${item.id}',true)">ğŸ”— Abrir ${refType} em nova janela</button>`:'';
  
  const modal=document.getElementById('frase-modal');
  if(!modal){
    const div=document.createElement('div');
    div.id='frase-modal';div.className='frase-modal-overlay';
    div.innerHTML=`<div class="frase-modal" onclick="event.stopPropagation()">
      <div class="frase-modal-header">
        <div class="frase-modal-header-left">
          <div class="frase-modal-spec" id="fm-spec"></div>
          <div class="frase-modal-name" id="fm-name"></div>
        </div>
        <button class="frase-modal-close" onclick="closeFraseModal()">âœ•</button>
      </div>
      <div class="frase-modal-body" id="fm-body"></div>
    </div>`;
    div.onclick=closeFraseModal;
    document.body.appendChild(div);
  }
  document.getElementById('fm-spec').textContent=(si.icon||'')+' '+(si.label||item.spec)+(item.sub2?' Â· '+item.sub2:'');
  document.getElementById('fm-name').textContent=item.name||'Frase';
  document.getElementById('fm-body').innerHTML=`
    <p style="font-size:0.72rem;color:var(--text3);margin-bottom:0.6rem">Clique no texto para copiar</p>
    <div class="frase-full-text" title="Clique para copiar" onclick="fraseInlineCopy(this,${JSON.stringify(item.text||'')})">${item.text||''}</div>
    <button class="frase-copy-big" onclick="copyFrase(${JSON.stringify(item.text||'')})">ğŸ“‹ Copiar</button>
    ${refBtn}`;
  document.getElementById('frase-modal').classList.add('open');
  document.body.style.overflow='hidden';
}
function closeFraseModal(){
  const m=document.getElementById('frase-modal');
  if(m){m.classList.remove('open');document.body.style.overflow='';}
}
// fecha modal com ESC
document.addEventListener('keydown',e=>{if(e.key==='Escape')closeFraseModal();});
function copyFrase(text){navigator.clipboard.writeText(text);toast('Frase copiada!');}
function openResumoFromFrase(rid){_0x7i8j('resumos',document.querySelectorAll('.mnb')[1]);setTimeout(()=>_0x5g6h('resumos',rid),150);}
function buildChkPanel(item){
  let html=`<div class="prog-info"><span id="ck-txt">0 de 0</span><span id="ck-pct">0%</span></div><div class="prog-bar-wrap"><div class="prog-fill" id="ck-fill" style="width:0%"></div></div>`;
  for(const[sec,items]of Object.entries(item.sections||{})){
    html+=`<div class="chk-sec-title">${sec}</div>`;
    html+=items.map(it=>`<div class="chk-item" onclick="toggleCk(this)"><div class="cb"></div><span>${it}</span></div>`).join('');
  }
  html+=`<div class="pd"></div><button class="btn-ghost" onclick="resetCk()">â†º Resetar</button>`;
  return html;
}
function toggleCk(el){el.classList.toggle('done');updCkProgress();}
function updCkProgress(){
  const all=document.querySelectorAll('#panel-body .chk-item');
  const done=document.querySelectorAll('#panel-body .chk-item.done');
  if(!all.length)return;
  const pct=Math.round(done.length/all.length*100);
  const t=document.getElementById('ck-txt'),p=document.getElementById('ck-pct'),f=document.getElementById('ck-fill');
  if(t)t.textContent=`${done.length} de ${all.length}`;
  if(p)p.textContent=pct+'%';
  if(f){f.style.width=pct+'%';f.style.background=pct===100?'var(--green)':'var(--accent)';}
}
function resetCk(){document.querySelectorAll('#panel-body .chk-item').forEach(el=>el.classList.remove('done'));updCkProgress();}

function calcEGFR(){
  const cr=parseFloat(document.getElementById('c-cr')?.value),age=parseInt(document.getElementById('c-age')?.value),sex=document.getElementById('c-sex')?.value;
  if(!cr||!age){toast('Preencha creatinina e idade');return;}
  const k=sex==='F'?0.7:0.9,a=sex==='F'?-0.241:-0.302,sf=sex==='F'?1.012:1.0,r=cr/k;
  const egfr=142*Math.pow(Math.min(r,1),a)*Math.pow(Math.max(r,1),-1.2)*Math.pow(0.9938,age)*sf;
  document.getElementById('rv-egfr').textContent=egfr.toFixed(1);
  document.getElementById('r-egfr').classList.add('show');
  let badge,cls,note;
  if(egfr>=90){badge='G1 â€” Normal (â‰¥90)';cls='rb-ok';note='Contraste iodado e gadolÃ­nio sem restriÃ§Ãµes baseadas em funÃ§Ã£o renal.';}
  else if(egfr>=60){badge='G2 â€” Leve reduÃ§Ã£o (60â€“89)';cls='rb-ok';note='Geralmente seguro. Monitorar se marcadores adicionais de lesÃ£o renal.';}
  else if(egfr>=45){badge='G3a â€” Leve-moderado (45â€“59)';cls='rb-warn';note='HidrataÃ§Ã£o EV recomendada. GadolÃ­nio linear contraindicado (risco FSN).';}
  else if(egfr>=30){badge='G3b â€” Moderado-grave (30â€“44)';cls='rb-warn';note='Avaliar risco-benefÃ­cio. Dose mÃ­nima. GadolÃ­nio macrocÃ­clico com cautela.';}
  else if(egfr>=15){badge='G4 â€” Grave (15â€“29)';cls='rb-bad';note='Contraste iodado e gadolÃ­nio contraindicados salvo emergÃªncia absoluta.';}
  else{badge='G5 â€” Insuf. renal (<15)';cls='rb-bad';note='Contraste iodado e gadolÃ­nio contraindicados.';}
  const el=document.getElementById('rb-egfr');el.className='res-badge '+cls;el.textContent=badge;
  document.getElementById('rn-egfr').textContent=note;
}
function calcTIRADS(){
  const comp=document.querySelector('input[name="tc"]:checked'),eco=document.querySelector('input[name="teco"]:checked'),forma=document.querySelector('input[name="tf"]:checked'),marg=document.querySelector('input[name="tm"]:checked');
  let fe=0;['tfe0','tfe1','tfe2','tfe3'].forEach(id=>{const cb=document.getElementById(id);if(cb?.checked)fe+=parseInt(cb.value);});
  const size=parseFloat(document.getElementById('t-sz')?.value)||0;
  let score=0;
  if(comp)score+=parseInt(comp.value);if(eco)score+=parseInt(eco.value);if(forma)score+=parseInt(forma.value);if(marg)score+=parseInt(marg.value);score+=fe;
  document.getElementById('rv-tirads').textContent=score;document.getElementById('r-tirads').classList.add('show');
  let tier,cls,rec;
  if(score===0){tier='TR1 â€” Benigno';cls='rb-ok';rec='Sem indicaÃ§Ã£o de biÃ³psia.';}
  else if(score<=2){tier='TR2 â€” NÃ£o suspeito';cls='rb-ok';rec='Sem indicaÃ§Ã£o de biÃ³psia.';}
  else if(score===3){tier='TR3 â€” Levemente suspeito';cls='rb-info';rec=size>=2.5?'PAAF recomendada (â‰¥2,5cm).':'Seguimento US: 1, 3 e 5 anos.';}
  else if(score<=6){tier='TR4 â€” Moderadamente suspeito';cls='rb-warn';rec=size>=1.5?'PAAF recomendada (â‰¥1,5cm).':'Seguimento US: 1, 2, 3 e 5 anos.';}
  else{tier='TR5 â€” Altamente suspeito';cls='rb-bad';rec=size>=1.0?'PAAF recomendada (â‰¥1cm).':'Seguimento US anual.';}
  const el=document.getElementById('rb-tirads');el.className='res-badge '+cls;el.textContent=tier;
  document.getElementById('rn-tirads').textContent='ğŸ“Œ '+rec;
}
function calcContraste(){
  const w=parseFloat(document.getElementById('c-w')?.value),conc=parseInt(document.getElementById('c-conc')?.value),egfr=parseFloat(document.getElementById('c-eg')?.value);
  if(!w){toast('Informe o peso');return;}
  const doseML=Math.min((w*450)/conc,100000/conc),maxML=100000/conc;
  document.getElementById('rv-ct').textContent=doseML.toFixed(0);document.getElementById('rv-ctmax').textContent=maxML.toFixed(0);document.getElementById('r-ct').classList.add('show');
  let badge,cls,note;
  if(!egfr||egfr>=60){badge='Liberado';cls='rb-ok';note='HidrataÃ§Ã£o opcional para alto risco (DM, IC, mieloma).';}
  else if(egfr>=45){badge='Cautela â€” eGFR 45â€“59';cls='rb-warn';note='SF 0,9% 1mL/kg/h, 6â€“12h prÃ© e pÃ³s.';}
  else if(egfr>=30){badge='Alto risco â€” eGFR 30â€“44';cls='rb-warn';note='Avaliar risco-benefÃ­cio. HidrataÃ§Ã£o agressiva.';}
  else{badge='CONTRAINDICADO â€” eGFR <30';cls='rb-bad';note='Apenas emergÃªncia absoluta com avaliaÃ§Ã£o nefrolÃ³gica.';}
  const el=document.getElementById('rb-ct');el.className='res-badge '+cls;el.textContent=badge;document.getElementById('rn-ct').textContent=note;
}
function calcBIRADS(){
  const score=['bi-f','bi-o','bi-m','bi-e','bi-p','bi-c'].reduce((s,id)=>s+parseInt(document.getElementById(id)?.value||0),0);
  document.getElementById('rv-bi').textContent=score;document.getElementById('r-bi').classList.add('show');
  let cat,cls,note;
  if(score===0){cat='BI-RADS 2 â€” Benigno';cls='rb-ok';note='Seguimento rotineiro anual.';}
  else if(score<=2){cat='BI-RADS 3 â€” Provav. benigno';cls='rb-info';note='Risco <2%. US em 6 meses.';}
  else if(score<=4){cat='BI-RADS 4A â€” Baixa suspeita';cls='rb-warn';note='Risco 2â€“10%. BiÃ³psia recomendada.';}
  else if(score<=6){cat='BI-RADS 4B â€” Sust. intermediÃ¡ria';cls='rb-warn';note='Risco 10â€“50%. BiÃ³psia indicada.';}
  else if(score<=8){cat='BI-RADS 4C â€” Sust. moderada';cls='rb-bad';note='Risco 50â€“95%. BiÃ³psia obrigatÃ³ria.';}
  else{cat='BI-RADS 5 â€” Altamente suspeito';cls='rb-bad';note='Risco >95%.';}
  const el=document.getElementById('rb-bi');el.className='res-badge '+cls;el.textContent=cat;document.getElementById('rn-bi').textContent=note;
}
function calcBosniak(){
  const cat=document.getElementById('bos-cat')?.value;if(!cat)return;
  document.getElementById('r-bos').classList.add('show');
  const M={'1':{label:'Bosniak I',cls:'rb-ok',note:'Cisto simples benigno. Risco 0%. Sem seguimento.'},'2':{label:'Bosniak II',cls:'rb-ok',note:'Minimamente complexo. Risco ~2%.'}, '2f':{label:'Bosniak IIF',cls:'rb-info',note:'Seguimento: TC/RM 6m, 1 e 2 anos. Risco ~5â€“10%.'},'3':{label:'Bosniak III',cls:'rb-warn',note:'Risco ~50%. RessecÃ§Ã£o ou ablaÃ§Ã£o.'},'4':{label:'Bosniak IV',cls:'rb-bad',note:'Risco >90%. Cirurgia indicada.'}};
  const m=M[cat];const el=document.getElementById('rb-bos');el.className='res-badge '+m.cls;el.textContent=m.label;document.getElementById('rn-bos').textContent=m.note;
}

function openRMCardiaca(){
  const ov=document.createElement('div');ov.style.cssText='position:fixed;inset:0;z-index:600;background:rgba(0,0,0,0.92);display:flex;flex-direction:column';
  const bar=document.createElement('div');bar.style.cssText='background:var(--surface);border-bottom:1px solid var(--border);padding:0.75rem 1.25rem;display:flex;align-items:center;justify-content:space-between;flex-shrink:0';
  bar.innerHTML='<span style="font-family:var(--serif);font-size:1rem">ğŸ«€ RM CardÃ­aca â€” Gerador de Laudo</span><button onclick="this.closest(\'div\').parentElement.remove()" style="background:none;border:none;color:var(--text3);font-size:1.1rem;cursor:pointer">âœ•</button>';
  const ifr=document.createElement('iframe');ifr.style.cssText='flex:1;border:none;width:100%';
  ifr.srcdoc='<html><body style="font-family:sans-serif;background:#f4f5f8;display:flex;align-items:center;justify-content:center;height:100vh;flex-direction:column;gap:1rem;color:#3d4354;text-align:center;padding:2rem"><div style="font-size:3rem">ğŸ«€</div><div style="font-size:1.1rem;font-weight:600">RM CardÃ­aca â€” Gerador de Laudo</div><div style="font-size:0.84rem;color:#7c8499;max-width:420px;line-height:1.7">Na versÃ£o publicada, o arquivo <code style="background:#e2e5ed;padding:2px 6px;border-radius:3px">rm-cardiaca.html</code> carrega aqui.</div></body></html>';
  ov.appendChild(bar);ov.appendChild(ifr);document.body.appendChild(ov);
}

function toggleTheme(){
  const isLight=document.body.classList.toggle('light');
  document.getElementById('theme-btn').textContent=isLight?'ğŸŒ™ Escuro':'â˜€ï¸ Claro';
  localStorage.setItem('rh_theme',isLight?'light':'dark');
}

function initVisitCounter(){
  const el=document.querySelector('#visit-ctr span:last-child');if(!el)return;
  fetch('https://api.countapi.xyz/hit/radiohub.ferramentas/visits')
    .then(r=>r.json()).then(d=>{
      const n=d.value||0;el.textContent=(n>=1000?(n/1000).toFixed(1)+'k':n)+' visitas';el.style.color='var(--accent2)';
    }).catch(()=>{
      const v=(parseInt(localStorage.getItem('rh_v')||'0'))+1;localStorage.setItem('rh_v',v);el.textContent=v+' visitas (local)';
    });
}

function toast(msg){const t=document.getElementById('toast');t.textContent='âœ“ '+msg;t.classList.add('show');clearTimeout(t._t);t._t=setTimeout(()=>t.classList.remove('show'),2200);}

function openRMCardiaca(){
  // Create fullscreen iframe overlay BELOW header
  const overlay = document.createElement('div');
  overlay.id = 'iframe-overlay';
  overlay.style.cssText = 'position:fixed;top:90px;left:0;right:0;bottom:0;z-index:9999;background:#fff;';
  
  // Create close button bar
  const closeBar = document.createElement('div');
  closeBar.style.cssText = 'background:#f4f5f8;padding:0.6rem 1.5rem;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #e2e5ed;';
  closeBar.innerHTML = `
    <span style="font-family:var(--sans);font-size:0.85rem;color:#3d4354;font-weight:500;">RM CardÃ­aca Â· Gerador de Laudo</span>
    <button onclick="closeIframe()" style="background:#e05c5c;color:#fff;border:none;padding:0.4rem 1rem;border-radius:6px;cursor:pointer;font-family:var(--sans);font-size:0.75rem;font-weight:500;transition:all 0.15s;">
      âœ• Fechar
    </button>
  `;
  
  // Create iframe
  const iframe = document.createElement('iframe');
  iframe.src = 'calculadoras/rm-cardiaca.html';
  iframe.style.cssText = 'width:100%;height:calc(100% - 50px);border:none;display:block;';
  
  overlay.appendChild(closeBar);
  overlay.appendChild(iframe);
  document.body.appendChild(overlay);
}

function closeIframe(){
  const overlay = document.getElementById('iframe-overlay');
  if(overlay){
    overlay.remove();
  }
}

// ============================================
// LOAD DATA FROM SUPABASE
// ============================================
async function _0x2c3d(){
  try{
    // Load templates
    const{data:templates}=await _0x1a2b.from('templates').select('*').order('name');
    if(templates){
      DT=templates.map(t=>({
        id:t.id,
        spec:t.spec,
        sub2:t.sub2||'',
        name:t.name,
        sub:SPECS[t.spec]?.label+(t.sub2?' Â· '+t.sub2:''),
        tags:t.tags||[],
        t:t.template_text
      }));
      console.log('âœ… Templates carregados:',DT.length);
    }
    
    // Load frases
    const{data:frases}=await _0x1a2b.from('frases').select('*').order('name');
    if(frases){
      DF=frases.map(f=>({
        id:f.id,
        spec:f.spec,
        sub2:f.sub2||'',
        name:f.name,
        sub:SPECS[f.spec]?.label+(f.sub2?' Â· '+f.sub2:''),
        tags:f.tags||[],
        rid:f.resumo_id,
        artid:f.artigo_id,
        text:f.text
      }));
      console.log('âœ… Frases carregadas:',DF.length);
    }
    
    // Load checklists
    const{data:checklists}=await _0x1a2b.from('checklists').select('*').order('name');
    if(checklists){
      DCK=checklists.map(c=>({
        id:c.id,
        spec:c.spec,
        sub2:c.sub2||'',
        name:c.name,
        sub:SPECS[c.spec]?.label+(c.sub2?' Â· '+c.sub2:''),
        tags:c.tags||[],
        sections:c.sections_json
      }));
      console.log('âœ… Checklists carregados:',DCK.length);
    }
    
    // Re-render grids after loading
    if(DT.length||DF.length||DCK.length){
      _0x3e4f('templates');
      _0x3e4f('frases');
      _0x3e4f('checklist');
    }
  }catch(err){
    console.error('âŒ Erro ao carregar do Supabase:',err);
  }
}

// Fecha dropdown ao clicar fora
document.addEventListener('click',function(e){
  const dd=document.getElementById('sub-dropdown');
  if(!dd.classList.contains('open'))return;
  if(dd.contains(e.target))return;
  if(e.target.closest('#hdr2'))return;
  _0xa1b2();
},{capture:true});

function init(){
  if(localStorage.getItem('rh_theme')==='light'){document.body.classList.add('light');document.getElementById('theme-btn').textContent='ğŸŒ™ Escuro';}
  
  // Load data from Firebase ğŸ”¥
  carregarDadosFirebase();
  
  SECS.forEach(sid=>_0x3e4f(sid));
  document.getElementById('upd-feed').innerHTML=UPDATES.map(u=>`<div class="upd"><div class="upd-date">${u.date}</div><span class="upd-badge ${u.badge}">${u.type}</span><div class="upd-text">${u.text}</div></div>`).join('');
  initVisitCounter();
  // URL query support para abrir conteÃºdo direto (usado ao abrir em nova janela)
  const params=new URLSearchParams(window.location.search);
  const openSec=params.get('open');
  const openId=params.get('id');
  if(openSec&&openId&&SECS.includes(openSec)){
    setTimeout(()=>{
      const idx=SECS.indexOf(openSec)+1;
      _0x7i8j(openSec,document.querySelectorAll('.mnb')[idx]);
      setTimeout(()=>_0x5g6h(openSec,openId),200);
    },100);
  }
}
init();
</script>

<script type="module">
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RadioHub v5 - Firebase Integration
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
import { getFirestore, collection, getDocs, query, orderBy, where } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

const firebaseConfig = {
  apiKey: "AIzaSyDPfsLU4-T9MTD8u2_6njXbzcXycGdRRyU",
  authDomain: "radiohub-5335d.firebaseapp.com",
  projectId: "radiohub-5335d",
  storageBucket: "radiohub-5335d.firebasestorage.app",
  messagingSenderId: "838191270589",
  appId: "1:838191270589:web:7ca04a776d9ea1a85305d4"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// CARREGA TEMPLATES/MÃSCARAS DO FIREBASE
window.loadFirebaseTemplates = async function(especialidade = '') {
  try {
    let q;
    if (especialidade) {
      q = query(collection(db, 'templates'), where('especialidade', '==', especialidade), orderBy('createdAt', 'desc'));
    } else {
      q = query(collection(db, 'templates'), orderBy('createdAt', 'desc'));
    }
    const snapshot = await getDocs(q);
    const templates = [];
    snapshot.forEach(doc => {
      const data = doc.data();
      templates.push({
        id: doc.id,
        nome: data.nome || '',
        especialidade: data.especialidade || '',
        texto: data.texto || ''
      });
    });
    return templates;
  } catch (error) {
    console.error('Erro ao carregar templates:', error);
    return [];
  }
};

// CARREGA FRASES DO FIREBASE
window.loadFirebaseFrases = async function(categoria = '') {
  try {
    let q;
    if (categoria) {
      q = query(collection(db, 'frases'), where('categoria', '==', categoria), orderBy('createdAt', 'desc'));
    } else {
      q = query(collection(db, 'frases'), orderBy('createdAt', 'desc'));
    }
    const snapshot = await getDocs(q);
    const frases = [];
    snapshot.forEach(doc => {
      const data = doc.data();
      frases.push({
        id: doc.id,
        categoria: data.categoria || '',
        texto: data.texto || ''
      });
    });
    return frases;
  } catch (error) {
    console.error('Erro ao carregar frases:', error);
    return [];
  }
};

// CARREGA CHECKLISTS DO FIREBASE
window.loadFirebaseChecklists = async function(exame = '') {
  try {
    let q;
    if (exame) {
      q = query(collection(db, 'checklists'), where('exame', '==', exame), orderBy('createdAt', 'desc'));
    } else {
      q = query(collection(db, 'checklists'), orderBy('createdAt', 'desc'));
    }
    const snapshot = await getDocs(q);
    const checklists = [];
    snapshot.forEach(doc => {
      const data = doc.data();
      checklists.push({
        id: doc.id,
        nome: data.nome || '',
        exame: data.exame || '',
        itens: data.itens || []
      });
    });
    return checklists;
  } catch (error) {
    console.error('Erro ao carregar checklists:', error);
    return [];
  }
};

// CARREGA RESUMOS DO FIREBASE
window.loadFirebaseResumos = async function(especialidade = '') {
  try {
    let q;
    if (especialidade) {
      q = query(collection(db, 'resumos'), where('spec', '==', especialidade), orderBy('createdAt', 'desc'));
    } else {
      q = query(collection(db, 'resumos'), orderBy('createdAt', 'desc'));
    }
    const snapshot = await getDocs(q);
    const resumos = [];
    snapshot.forEach(doc => {
      const data = doc.data();
      resumos.push({
        id: doc.id,
        titulo: data.titulo || '',
        spec: data.spec || '',
        tags: data.tags || [],
        body: data.body || '',
        texto: data.texto || ''
      });
    });
    return resumos;
  } catch (error) {
    console.error('Erro ao carregar resumos:', error);
    return [];
  }
};

console.log('ğŸ”¥ RadioHub v5 + Firebase carregado! Use loadFirebaseTemplates(), loadFirebaseFrases(), loadFirebaseChecklists(), loadFirebaseResumos()');
</script>

</body>
</html>
